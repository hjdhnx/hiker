var updateLog = `
2022/08/24 åºŸé™¤éƒ¨åˆ†ä»£ç 
2022/08/22 ä¼˜åŒ–è‡ªåŠ¨æ¨¡æ¿åŒ¹é…çš„é€šç”¨å…å—…,ä¿®å¤æœç´¢çš„è‡ªåŠ¨åŒ¹é…
2022/08/21 è®°å½•ç¿»é¡µä½ç½®(ä¼ªè¶³è¿¹,ä¸èƒ½è§£å†³ç¿»é¡µä½†æ˜¯æ²¡è§‚çœ‹çš„è¶³è¿¹é—®é¢˜),æ™ºèƒ½æœ€æ–°ç« èŠ‚ä¼˜åŒ–
2022/08/20 å¢å¼ºå°è¯´æ¨¡å¼å…å—…æ¢ï¼Œå†…ç½®å‡€åŒ–å†…å®¹,ä¼˜åŒ–è‡ªåŠ¨åŒ¹é…æŠ›é”™é—®é¢˜,ä¸€çº§å¤„ç†åˆ¤æ–­ è‡ªåŠ¨åŒ¹é…å±æ€§ä¸ºçœŸçš„æ—¶å€™æ‰æŠ›é”™ã€‚äºŒçº§å¢åŠ åŒå‡»çº¿è·¯åç§°å¿«é€Ÿåˆ‡æ¢é€‰é›†æŒ‰é’®æ ·å¼
2022/08/19 å¢å¼ºæ¼«ç”»æ¨¡å¼å…å—…æ¢
2022/07/28 codingä¾èµ–é“¾æ¥å…¨éƒ¨è½¬ç§»è‡³csdn
2022/07/15 ä¿®å¤è“è“å½±è§†å¤šå¤šèµ„æºæ²¡æ³•é€šå…çš„é—®é¢˜
2022/07/08 å¢åŠ config.uiæ’ä»¶ï¼Œå¯è¢«å¼•ç”¨
2022/07/07 å°è£…äº†å¦å¤–ä¸€å¥—å¸¸ç”¨åŠ¨æ€åˆ†ç±»å†™æ³•ï¼Œå‡½æ•°ä¸ºåŠ¨æ€åˆ†ç±»(ä¸€çº§åˆ—è¡¨å˜é‡)
2022/07/06 ä¼˜åŒ–åŠ¨æ€ç¿»é¡µé€»è¾‘ï¼Œå¢åŠ bug
2022/07/05 dræ¨¡æ¿å‡çº§åˆ°5.0ï¼ŒäºŒçº§ç¿»é¡µç»„ä»¶å‡çº§ä¸ºåŠ¨æ€å…ƒç´ åˆ‡æ¢
2022/07/04 è°ƒæ•´è‡ªåŠ¨ä¸€çº§å‡½æ•°çš„å‚æ•°é¡ºåºï¼Œhtmlå‚æ•°æ”¹åˆ°catesä¹‹å
2022/06/29 æ–°å¢ç£åŠ›å…¼å®¹,æ–°å¢å—…æ¢ç»“æœå¤„ç†
2022/06/21 å¢åŠ ç‰›é€¼åŠŸèƒ½äºŒçº§å¤„ç†=>é™„åŠ æ•°æ®,é™„åŠ æ•°æ®æ ‡é¢˜ï¼Œå†…å®¹é™„åŠ æŠ˜å åˆ°ç®€ä»‹åé¢
2022/06/20 å…¼å®¹ç£åŠ›é“¾æ¥åŠ¨æ€è§£æ
ä¸€çº§æé€ŸåŠç§’ä»¥ä¸Šï¼Œç›¸æ¯”ä»¥å‰æå‡1.2å€ã€‚3.0æ”¯æŒå¥—å°è¯´äº†!æ”¯æŒå®Œç¾è‡ªåŠ¨è·å–æ™ºèƒ½æœ€æ–°ç« èŠ‚.æ”¯æŒéªŒè¯ç è¯†åˆ«.å°è¯´æ¨¡å¼ä¼˜åŒ–ã€‚äºŒçº§é¡µé¢å¸¦cookie.å–æ¶ˆç¨‹åºè‡ªæ¯.æ”¯æŒå°è¯´ä¸‹è½½ã€‚æ–°å¢æ”¶è—äºŒçº§æ˜¾ç¤ºå•è§„åˆ™å
`.trim();
var version={
    author:"é“é•¿",
    ver:"5.2.1",
    // appv:2316,
    appv:583,
    requireId:"http://hiker.nokia.press/hikerule/rulelist.json?id=2505",
    update:'2022/08/24 14:25',
    info:updateLog,
    ua:';get;utf-8;{User-Agent@Mozilla/5.0&&Cookie@}',
    ok:'https://okjx.cc/?url=',
    jsRoot:'https://dr.playdreamer.cn/js/',
};
putVar('drä¾èµ–',version.requireId);
/*
var lsg = (function() {
    evalPrivateJS("XnUmRAbE641s4myhkr5brclFfsHk4YBZw7AEwR2RDZo=");
    pathto=undefined;
    evalPrivateJS("88URiYONBZk7lZl1XzdcYPYjki0FFljXcsScMvf57IVeG8kaqJA3v1ov4EIK0M0wLXT+eQCrYAGW4xepT8Zc7KMeZ4JdY/wNA4WGOYrW2d7R31kwJDb1LNtHAkEptR9S3Y8kq1iKCaauktnO0IZcowTBX+2urTqu4QcB4Nn39Uc3m9T+Ub0IZ+TV4rFaO7aafLGW2N/kLzi9K+T4R2hKRan1cgu+y5BUF99ZzUhIyttxY6uB6DZbJ9ZIMZA+N7n4nw7MC6Pin1vWiqnyT+L8bhjYhs1eN0wTfLeiyB15ONiZpfnnnSR731uwjSt9Pa701XVZZZJkzs9bDj3OnFYwyyRNqqa6BkRJuqHYLZ55poUlDsI9YFGrk2rW4KdSp5V8bhVZAw1vItpRYwgOoIkpbk+4SLYMwhd4asPDLqj4DJXVifw42Pw3C6mGufNCspwQ12kxNv3MA+N2xK3bVuAHtPFqKqlZSOKojtxfMM0Teuws5y95anljhZRFclFjpSrvKs1ZFw/1UvdN3wdpQ7p9KSwV0NhYPSvPL5EzBQOQwux8sDMgggeOw2g+E7AFWu35Yffd8LK/eVgwgurlbWIhm2BJLbhSqWdQ1NazjNdJFKHTpfxdwW33lyqbYqll5U76gwckeCEtl1vImnRj76QSqrWsAu8Qpx+5065LTZrU7oRx3z5IrLyB1KwZcZdSja4Ean0uxLeChAwYIceGlNvSwWXK07gcRh4k7H+ouz5lu2aP9tes3IptDnQDkQRESgYfMzX07woxiErgbmqO3vsdz/H8w8mXgX3qq9RW8denSZQs+Y3wkoTFyWyUuzEB9Ik7FlJvHnZuvchBhdVQIT3pFMoYQHQu49V7EgA2PxZy1ZCMCT/MakpPTF3iz7T6WayiemSvy0GwnKD6F/kCxQuiM/J0ZhwUhgmEkY4QC5krkuJsZjpjAzdBw+z86uDHLoN3AxEZZxpT5DEwo4glnH4q6NUT6jzALjDij9l3RPugQ5LErolXdoeuOE9woPBuKsG/Jj0u/jgZGssz0nnKKUFJc3xSAw8fu0DiHCCXAy45/1sEqK9qN5hVt9eVxxx0G5NyOpYJm2XQAJfl1pjbE+jnh41IrNvl6TvaU98Srwon67f5PwAmn0wwqbcRl8or+x90vGeww1phYzn6GQpfNOimENEfFSQ5/RYwS7ijIqgnYSrZpE+8ApKlyz+giUBWKRznDpBukkYs9ffCJEB5KdYSpCOm0OWVfhXMbTtobEcX1rJWhb15iCgEWBhx7/qOmlkcPhfhXGoilxML01pgqoDsYor5pOtlZTDA3bVA62vx6rGnbiIwjZnX5Dvo1c9m8SgG0fu5F2m9H6WPgAoH2oS6n0hecO61iwp2rYsyS/C01NDVc7xUyEJUB7mxtCHTc5Zwh/34cXanmvH5Pt6NC32QGxwkgTlBRe/Sz5igYgSrkYhyjJuSuDEwycewUaU1TeUK/jHDq24s6RTMm5m7XiTAJwjlI7+SzCv1Uh1dDPTtjTU873LlyBK4K9Q/z7oBZoTlh5PzEnRQ5QajA6RPMfeWI3tefDUTWsldNtC9a0J3F+e//eDLgh0y8x1pLqbZvCp0wdxW9m9eOny1SJ0X71v47fT5t8XHyHtgGDTQAyzpyIqEjbRSTutLGPYliLdsuViheuOS4cGlGY5kRDBp9oWbuB0+1ujS5l1fQpU+YClrLKH84oer2ceLSpRQRCgujX9jn28LyfzmjxxNL9bCeook07Aop8VmQcTt2K3Lfh1RDYb1cQjYIu0uMmDw7WZfZzwifG8IuJeSqYjcbLPX2mB1k3U7deTr7+FQPax85L1IUcLXJFbV72BQljwUK96GV3aQiZTcoGNb04MZ7d6Hg3YzvVtVduqIpRWMlxWfr+xBxPBvx6oc+1TEUaOwvSHJ0CZWlmvJ4hcgvl3kxzxFoRLtn6PstAo/ueW03xdyCLvM8FXLK8tI1lZz+wif+9ZIAdT2tawC7xCnH7nTrktNmtTuhM7VsDa8QJ8Ek2uX0RD7rc/5/Rr48IWz/MjKkFXVnzF+HyvYjTnq/12wCfXftMscFDqlm1PZ4UI3TFa+2v4vDv/VE+o8wC4w4o/Zd0T7oEOS+pNSuz8nY7vjb8A++8aS4U3a094dUWQGh87/uMhCWn2luTI8rjVGcXIE+FUJEyneS5r8Jic+LFIvbAVPZDSCP7F+ITOlx8sFnfN0QjCYfR3r9sHpiWKlELqPgG+cbGEbIlkdDuX5wJ8RxgpPttpqOhnP0tntCBglrx3m2ItlHzcUMJSe35rKj6KnWEolwB38ohMjk0/I+RKdi089DgoMb9ckVtXvYFCWPBQr3oZXdpD5gpGWRocXMJbT27oWUkeczbFwwXDKNQHYqvS1215v0HVBfs+cE+T/tYcC6Nq62UXmIkxLcDEAamcoH7wCUnZ5HQvJ0f/0wPF2kLmU3u0yEUmDK276V2vJ2HXuXHeC3WGEO/xUON6h4H/c9jVcT+u2MiRbkI9CfjjmRQzoET4EJWApcH7iGlIUoMHmmJm+VlyrCsUlkJbBYhccINqWHcpvXI1oJXDnb3umswGa3qeU/R3eqQy55RMaAqlB5VkEsqEcYzJsoSQSpi3tKLPPz6LVESF2vWlvCY/ht1Rjug03d1iEyLcaEA7LaaL86qvD4YrvL9RMxQExEFms6yJdXGngeaTjHSH1DSZ9blRYBRlzjcZkJxB2lxHlslitE6tqy9DRCeury0Z+5YFiBup8kQ4JgNdvFxNmm+a79VYLIoNZvjd4V2TAgZbWE0Z309RGcrdGNabMakJD/00XChOSUOIPXjNKmFOPL/8h1n1sCg2lZmiZ4RqdcF6uWuwTffjhnDnzTzTgJR7jTHxs1DspFUSe5Roo7sNwWj9St76IaOwOYHPIc6CyRIbDDVPgU3fDG9/XJFbV72BQljwUK96GV3aQO8YEMZAzndY0a+jXQGJNIOMl3k3Sy09GKB64FCq1elzDi2YEg1D4pTy93SbvQ2DXJGNrkd3BhnjRKsYB34nolmhuQ0VqsZjhVsQ1py6CagHT/drCgPUivvzR7Kn9dwjrNCZ1PQDL8H3cRs3HE9nUkx5bbJYWsPxb825gnEpWU9Z9Ktzvsli7/heOlDKpHxJbrB1R66TAggmfilJ4RpsKPl3hwRo2Xes2htT6Ai3QMUSsZBwvhm0ZyfBZdg4l/PIeRDaKSOX2YofBZUyfbjUBzLEMC8fc/JTFYPUQWwHv3m9jFfGWzpVS1Z/F6t54jYaLPeO3gzR4w6rM4WK3EwvmyyDjZEt4XZXJMwfhx9z8r4rZ7RCDXE7Uo6RJdzBZ6p1/oc+BC9peLxm7ifjsmAdzNuKvpV23EK+ezN02lZTmkAjJrRiAIIOefbxH6Cuy/cntoL6Fs34K40wTy4zSS/lZcCfX1BHEh1r5PH6cp8PgZGAo5m/w3s32NcPCQfgulKD19Pm3xcfIe2AYNNADLOnIilifJMF8+BtcgZM3GoK2L96AbPr7aVIr36/IfcJTCqjnuW+gJxpHI+kXgmcEvFXnEoq7PPnpFhEYbHLTtFi4xh67rW7oBcqBvPU4nxdWbPGo1mlA6pF5ahIuMffObWjFCZAVt1I2Qnc1alwbnoNqMMiXw3alLmltuTEV6KGtBntBqIQw1r7IKNxLiw13YjSy0bw22dU2nSWI+h5FI7CGblFWjlqww1DSqgEN/p1/wQVtlz9BbyAdcFseh4oaSBHe91ifJMF8+BtcgZM3GoK2L979AyGNq4wzb3QYNWuT4X9LlWXfNM/lQlWwQgFaPLg9fwl+XBYI2Imq4XsGDFeD3fPJ+JYHecLF1Cfuhdx5ibbDAH/xL1VmugaXOGaPB2qc7WOrafUDAIXLA0utgGpE9cmLk1riNHDTqZydcOx5j+YRgNdvFxNmm+a79VYLIoNZvo2roXJKkR1bkC9n8UGtjLf/RAtellVXaUlt92pER0bJPU2Buc1uwr7KUr7ENZAypH3m5yykR9ttGaTcLHgsWoNxCqpp5B53DBkJwIHPnnMHftd3wMBV5TC3FnBPPrscRX/73anGSbD5noTKaC4Bjc6DE7UXwAuegbVSNsv8BwlrWrP2nZ4uxFc8FBeoLbgGdQNwAIFAoG9icCd9L7xKqqthDctThHh+9YIXg1Vh67Dc68MwCmuoPVEmojB6opG9/srbV/RSgvl/x9CjNIN1z24AIXJjPLyBf1gIadbo6QfDqVoqIxjGOGIO2x6qjkxBv2lLLWPe51RlppMYgRtHdXh8TRTK4+a2073yGrPFBu14xqUy1Jx7ZYtyPJdUZ+mp0DCFmPvn8znewphfbNGA5JMB81IP/mVlhI1TEl8pMOCJ94p46Us/g+iuWHA2sdHuEG9H6BhIBz3bEnouOknZC4qq5P6GUmNUO1qgDd4glDCPzpQy+w7887DkJyvv2wnOJ5iDx2h0LyGyiAZLH/hpStPCAQbmwGlDEAfOiyqtqLQ9JWErwB8pH8d/4ilpKOVZBvOi6ULnXvV8YGst+6gsYjC7il6iEhCenlZoKxS/fA6sheR1J7W4/7th8FGRZIy1pVWFxvDgb0UMs1dRARTuPS2TLUrGhwLqJK4jvubBmNbkV/B2E7meWYN8xkGv58R7wS4XT0/atm8oTNVbQKz+AL7TmglD8A+3sTZo2W/TPNbr/6+oRnq3l9EG0tL+AboZAam8UvJnKhw1qNtJ82Ad9AgwhZj75/M53sKYX2zRgOSTAfNSD/5lZYSNUxJfKTDgiYJE5C3nuYWs6PI8fj2qn3uURJjQz/ipm5HL9EOEPKGJax0mPYfQG3t8wyeVcvphJmBnRAeL7p9QsXln+4b2Gu2qMPj85mkT9I5rE22lUku0L41nTHhslujkjO5jKkzwxT4X4VxqIpcTC9NaYKqA7GKK+aTrZWUwwN21QOtr8eqxANlgQGhD69C7lClET/moyNqeIcjFDUHBZcFDeuK+ujGMepSUsjl8P4bTV9fJFHjt1g9awFZjSS/NiXo1MuO6enMRjO4dxjjVTHABFupVEo6maCLkzSBCRTb8chCk5cU4zhNuAg/MAwErgPHOa5dFGrd4rwuLvUAU32/7wpjSYv0AH2m3DxvlLFprGDUSvoPITHLLgZoYePDaYUb3m1UKqup3CsXNZxR1jFuTOqH/s/EEQsGkljkrSDCA5NZToac90AZpS74eqojOGnrisTapoK4r27PIeHeuisSZ0pVqRWpJW8dVOOcasnlceM2OqFBreV+Q0gixYEdZF07qanvdXPmHjpaBLof4Rp1sqjB7TNxeC0eZTBLqIqxPJGv2xlfIO9SLr5T3I+vCROvLo4CTTK9oQJZNPHl/f4bM4D4KBvHtDa616AofQ2AIPmuFeufFvXwZGNc1xmU/8ueGIAixxhMvX6IdYNi9Ga88zC04eELiU0ZPAOUEwjHLyehUkaei7eBp9NX6cJJ/5sh9PtU1TirNWRcP9VL3Td8HaUO6fSmLYIDyut6k+oqcj6C9Ezgt19wDLqW74TH7qjmS5+DmddkpAaZzQ9FFpHVjjqdkd9TAd6UPWWgR6wLIPnTUftFj045Yi5FZ8MVTJIWsPq9L0bi9c7pS0o9CcR5CJoBuA5Le55+gw0EjHkRRTFkJbJ5G1fe+iWpdY2PKEctLuSfpH5RWymMwPs1hz4NaNQvZvayXw3alLmltuTEV6KGtBntBX+yz36RPDMyGIKe+3fzcxcsry0jWVnP7CJ/71kgB1PYeaV3YwrYEkjp6Ki+OYrGu6BkHn3DgE+giWbwhor6xaOB6MRNSvdqbuf7lrek12YDQTaMVS0N0OkUvLjP1UitjfNtlB/sNifcJMibGUJ8VqKwcaNES5Xc6dQY5nqeiq8uJTAI9uFIJcn0sr6DViJGr+cIOfbQyh1VWRU2jM+oxdtmpLnAo9AZdgGJPiXXWoVvLK8tI1lZz+wif+9ZIAdT29D1VQL8BOQl9OWgyW0N5XkCj3ORprLd0oBrn8/EAZEPLK8tI1lZz+wif+9ZIAdT2VAj6ItH4UIcNOOej0sm/gNVJ0M9hhYE0laYcCKQTA3Fl8glU4nYStdeQox8cmMFp94p46Us/g+iuWHA2sdHuEGGlgAdiERhSX1zvlj9H/SAXnp0+VZKC2akKwFBochJWQGhhFPcKyo0MX8U5MyWRHiFRQ6EwgNEi6x1ir0L6B0wtz3tcuE0z9CAID1pFcy0DFKEcZu49dICfbXSwAOrX/vNT382lopULNRXHSmII4zH5gpGWRocXMJbT27oWUkeczqK+tS3oX/2KWkkEzipaXcIwumUEf9ZCfhQaRLLDcTKK4q5cVUVLpfRtbDzbj5qCpuxnQy2rz8FatpW1OJJstU7fgneYpdeR19+4n6snyiWI2lgv9rvuutwxhpVAFzZKmcKb/VyUHBR+pqaNwKrYh4F6X/UGEWQRt72MuLE/boNZ25/8/a3H1UcfqsdwdPuQxcT/xJePh4b/YWxQ5iQv0FX2p2obP8tImcXEi9DyQHE=");
    return $.exports;
})();
*/
var lsg = evalPrivateJS("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");

var å–éšæœºåˆ—è¡¨ = function(arr, num) {
    var sData = arr.slice(0), i = arr.length, min = i - num, item, index;
    while (i-- > min) {
        index = Math.floor((i + 1) * Math.random());
        item = sData[index];
        sData[index] = sData[i];
        sData[i] = item;
    }
    return sData.slice(min);
};

var å–éšæœºé¢œè‰² = function() {
    return '#' + ('00000' + (Math.random() * 0x1000000 << 0).toString(16)).substr(-6);
}

var æ±‰å­—è½¬æ•°å­— = (function(){
    var map = {
        "é›¶": 0, "ä¸€": 1, "å£¹": 1, "äºŒ": 2, "è´°": 2, "ä¸¤": 2, "ä¸‰": 3, "å": 3,
        "å››": 4, "è‚†": 4, "äº”": 5, "ä¼": 5, "å…­": 6, "é™†": 6, "ä¸ƒ": 7, "æŸ’": 7,
        "å…«": 8, "æŒ": 8, "ä¹": 9, "ç–": 9, "å": 10, "æ‹¾": 10, "ç™¾": 100, "ä½°": 100,
        "åƒ": 1000, "ä»Ÿ": 1000, "ä¸‡": 10000, "åä¸‡": 100000, "ç™¾ä¸‡": 1000000, "åƒä¸‡": 10000000, "äº¿": 100000000
    };
    // è§£æå¤±è´¥è¿”å›-1ï¼ŒæˆåŠŸè¿”å›è½¬æ¢åçš„æ•°å­—ï¼Œä¸æ”¯æŒè´Ÿæ•°
    function numberDigit(chinese_number) {
        var len = chinese_number.length;
        if (len == 0) return -1;
        if (len == 1) return (map[chinese_number] <= 10) ? map[chinese_number] : -1;
        var summary = 0;
        if (map[chinese_number[0]] == 10) {
            chinese_number = "ä¸€" + chinese_number;
            len++;
        }
        if (len >= 3 && map[chinese_number[len - 1]] < 10) {
            var last_second_num = map[chinese_number[len - 2]];
            if (last_second_num == 100 || last_second_num == 1000 || last_second_num == 10000 || last_second_num == 100000000) {
                for (var key in map) {
                    if (map[key] == last_second_num / 10) {
                        chinese_number += key;
                        len += key.length;
                        break;
                    }
                }
            }
        }
        if (chinese_number.match(/äº¿/g) && chinese_number.match(/äº¿/g).length > 1) return -1;
        var splited = chinese_number.split("äº¿");
        if (splited.length == 2) {
            var rest = splited[1] == "" ? 0 : numberDigit(splited[1]);
            return summary + numberDigit(splited[0]) * 100000000 + rest;
        }
        splited = chinese_number.split("ä¸‡");
        if (splited.length == 2) {
            var rest = splited[1] == "" ? 0 : numberDigit(splited[1]);
            return summary + numberDigit(splited[0]) * 10000 + rest;
        }
        var i = 0;
        while (i < len) {
            var first_char_num = map[chinese_number[i]];
            var second_char_num = map[chinese_number[i + 1]];
            if (second_char_num > 9)
                summary += first_char_num * second_char_num;
            i++;
            if (i == len)
                summary += first_char_num <= 9 ? first_char_num : 0;
        }
        return summary;
    }
    $.exports = numberDigit;
    return $.exports;
})();

if(typeof(config)==='undefined'||!config){
    // eval('config = {}');
    var config = {};
}
function color(text, color) {
    text += "";
    if (text.indexOf("â€œâ€œâ€â€") === 0) {
        text.replace("â€œâ€œâ€â€", "");
    }
    return "â€œâ€œâ€â€<font color='" + color + "'>" + text + "</font>";
}
function htmlTag(tag, text) {
    text += "";
    if (text.indexOf("â€œâ€œâ€â€") === 0) {
        text.replace("â€œâ€œâ€â€", "");
    }
    return "â€œâ€œâ€â€" + "<" + tag + ">" + text + "</" + tag + ">";

}
function small(text) {
    return htmlTag("small", text);
}

function right(text) {
    return '<span style="float:right">'+text+'</span>';
}
function blank(){
    return '\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'
}
function isPic(str){
    return /\.(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(str);
}
function gbkç¼–ç (code){
    return encodeStr(code, 'GBK');
}


function getJdCk(ck){//è·å–äº¬ä¸œcookie
    // m.jd.com ç™»å½•åå–gifä¸Šé¢çš„cookie. æœåŠ¡å™¨é‡Œ docker-compose up -d
    // docker exec -it jd_scripts /bin/sh -c "node /scripts/jd_bean_sign.js |ts >> /scripts/logs/jd_bean_sign.log 2>&1"
    // docker exec -it jd_scripts /bin/sh -c "node /scripts/jd_fruit.js |ts >> /scripts/logs/jd_fruit.log 2>&1"
    // é’é¾™é¢æ¿æ‹‰åº“ ql repo https://ghproxy.com/https://github.com/okyyds/yydspure.git "jd_|jx_|gua_|jddj_|jdCookie" "activity|backUp" "^jd[^_]|USER|function|utils|sendNotify|ZooFaker_Necklace.js|JDJRValidator_|sign_graphics_validate|ql|JDSignValidator" "master
    // ä¿®å¤ä¾èµ– 01  docker exec -it qinglong bash
    // ä¿®å¤ä¾èµ– 02  curl -fsSL https://ghproxy.com/https://raw.githubusercontent.com/shufflewzc/QLDependency/main/Shell/QLOneKeyDependency.sh | sh
    // æ•™ç¨‹ https://thin-hill-428.notion.site/1c598629675145988b43a37998a1604a
    // æ•™ç¨‹ https://blog.csdn.net/qq_29183811/article/details/120247352
    // æ•™ç¨‹ https://thin-hill-428.notion.site/Ninja-7e693618f706453ab01d869fbd2adb69
    // é…ç½®ç¯å¢ƒå˜é‡: JD_COOKIE
    // nginx -s reload ql.nokia.press
    document = typeof(document)!=='undefined'?document:{};
    ck = ck||document.cookie;
    let obj = ck.split(';').map(it=>{return {key:it.split('=')[0].trim(),value:it.split('=')[1].trim()}});
    obj = obj.filter(it=> ['pt_pin','pt_key'].includes(it.key));
    obj=obj.map(it=>it.key+'='+it.value);
    return obj.join(';')
}
function getTxCk(ck){//è·å–è…¾è®¯è§†é¢‘cookie
    document = typeof(document)!=='undefined'?document:{};
    ck = ck||document.cookie;
    let obj = ck.split(';').map(it=>{return {key:it.split('=')[0].trim(),value:it.split('=')[1].trim()}});
    obj = obj.filter(it=> ['vqq_appid','vqq_openid','vqq_access_token','vqq_vusession','vqq_vuserid'].includes(it.key));
    obj=obj.map(it=>it.key+'='+it.value);
    return obj.join(';')
}

function getAliToken() {//è·å–é˜¿é‡Œäº‘çš„refreshtoken,ç½‘é¡µç‰ˆç™»å½•åæ§åˆ¶å°æ‰§è¡Œå³å¯
    //è¿™ä¸ªcookieè·å–åæ— æ³•ä½¿ç”¨æ–‡ä»¶ç›´é“¾ï¼Œéœ€è¦å»æ‰‹æœºappæŠ“token
    //è·å–ç§»åŠ¨ç«¯cookieï¼›https://alist-doc.nn.ci/docs/driver/aliyundrive
    return JSON.parse(localStorage.token).refresh_token;
}

function é¢„å¤„ç†å›ºå®šä»£ç (){//ä½¿ç”¨: require(version.jsRoot+'é¢„å¤„ç†.js')
    var dr_jsRoot = 'https://dr.playdreamer.cn/js/';
    try {
        const {getApi} = $.require("hiker://page/utiliy?rule=é“é•¿ä»“åº“Pro");
        var æ¨¡æ¿ = getApi('importUrl')+"2505";
        require(æ¨¡æ¿);
        é¢„å¤„ç†(æ¨¡æ¿)
    }catch (e) {
        log('é¢„å¤„ç†æ‰§è¡Œå¤±è´¥:'+e.message);
        var æ¨¡æ¿ = dr_jsRoot+'dr.js';
        require(æ¨¡æ¿);
        é¢„å¤„ç†(æ¨¡æ¿)
    }
}

function æ£€æµ‹ä¾èµ–å›ºå®šä»£ç (){
    // codeberyRoot:'https://gitlab.com/hjdhnx/hiker/-/raw/main/js/',
    // gitlabRoot:'https://codeberg.org/hjdhnx/hiker/raw/branch/main/js/',
    require('https://codeberg.org/hjdhnx/hiker/raw/branch/main/js/ä¾èµ–æ£€æµ‹.js');
    require('https://gitlab.com/hjdhnx/hiker/-/raw/main/js/ä¾èµ–æ£€æµ‹.js');
    æ£€æµ‹ä¾èµ–();
    //åŠ å¯†å
    evalPrivateJS('4ZFai6WdmDyH6oz/nhtVRLmKvoUg5wsLHMYcQURS3FcFSnRsh1drySmlUaq9i+3wo+Jg4/0WltZSeEhk515pl8ugSp/sJ0bZBw6cihfXZOTm6bWDcENtECiauhBo5b3DVfanahs/y0iZxcSL0PJAcQ==');
    //æ–°çš„åŠ å¯†å
    evalPrivateJS('4ZFai6WdmDyH6oz/nhtVROAIx1c0dRGZtfmf6PyWCr6dHnPVIOLddKI4gXInyEoixmC+cyqM8V/plDjccHPKYdMRRu3DLjeWtkw/W5GbPWQVKdbbEohqdTqYxEM0KWdh');
}

function ä¾èµ–æ£€æµ‹(){ // ä¸€çº§è¿›è¡Œä¾èµ–æ£€æµ‹ï¼Œå›ºå®šå†™æ³•ï¼ŒåºŸå¼ƒåŸæ¥çš„æ£€æµ‹ä¾èµ–å›ºå®šä»£ç 
    require(version.jsRoot+'ä¾èµ–æ£€æµ‹.js');
    æ£€æµ‹ä¾èµ–();
}

function é¢„å¤„ç†(æ¨¡æ¿å‚æ•°,ckUrl){
    æ¨¡æ¿å‚æ•° = æ¨¡æ¿å‚æ•°||false;
    ckUrl=ckUrl||"";
    // log('è¿›å…¥äº†é¢„å¤„ç†...');
    æ¨¡æ¿ = (typeof(æ¨¡æ¿)!=='undefined'&&æ¨¡æ¿)?æ¨¡æ¿:æ¨¡æ¿å‚æ•°;
    éªŒè¯ç  = (typeof(éªŒè¯ç )!=='undefined'&&éªŒè¯ç )?éªŒè¯ç :ckUrl;
    ua = (typeof(ua)!=='undefined'&&ua)?ua:false;//æŒ‡å®šua  var ua = PC_UA;
    let å…¨å±€ua=lsg.getItem('ua','ç”µè„‘');//ç”µè„‘ æ‰‹æœº
    let obj = {
        æ¨¡æ¿:æ¨¡æ¿||config.æ¨¡æ¿,
        æ ·å¼:['æ»šåŠ¨','é»˜è®¤'].includes(lsg.getItem('æ ·å¼','æ»šåŠ¨'))?lsg.getItem('æ ·å¼','æ»šåŠ¨'):'æ»šåŠ¨',//æˆ–è€…ä¸å¡«å°±æ˜¯é»˜è®¤
        æŒ‰é’®æ ·å¼:lsg.getItem('æŒ‰é’®æ ·å¼',''),//ç©º
        ua:å…¨å±€ua,
    }
    if(ua){//æŒ‡å®šuaåŠ å…¥config
        Object.assign(obj,{æŒ‡å®šua:ua});
    }
    initConfig(obj);
    let def_ua = å…¨å±€ua==='æ‰‹æœº'?MOBILE_UA:PC_UA;//æ ¹æ®å…¨å±€UAè·å¾—çš„uaå­—ç¬¦ä¸²
    def_ua = ua||def_ua; // å–æŒ‡å®šuaå’Œå…¨å±€uaä¸­çš„
    // log('æœ¬å°ç¨‹åºé¢„å¤„ç†é»˜è®¤UA:'+def_ua);
    //å…ˆé¢„å¤„ç†ä¾èµ–,åè·å–cookie
    if(/^http/.test(éªŒè¯ç )){
        // log('éªŒè¯ç :'+éªŒè¯ç );
        if(!getMyVar('cookie')){
            let ret = fetchCookie(éªŒè¯ç , {
                headers: {
                    "User-Agent": def_ua
                }
            });
            // log('cookie:'+ret);
            let cookie = JSON.parse(ret||'[]');
            putMyVar('cookie', cookie.join(';'));
        }
    }
    å¼•å…¥åŠ¨æ€åˆ†ç±»()
}

function åŒ¹é…è®¾ç½®(col_type){//ç”¨äºä¸€çº§è®¾ç½®
    let d = [];
    col_type = col_type||'scroll_button';
    d.push({
        title:'æ¸…é™¤åŒ¹é…è®°å½•',
        col_type:col_type,
        url:$('æ¸…ç©ºåŒ¹é…è®°å½•ä¸‹æ¬¡ä¼šé‡æ–°åŒ¹é…,ç¬¬ä¸€æ¬¡åŒ¹é…é€Ÿåº¦å°†å˜æ…¢,ç¡®è®¤æ¸…ç©º?').confirm(()=>{
            clearMyVar('ssmuban');
            clearMyVar('muban');
            clearMyVar('yjmuban');
            return 'toast://äºŒçº§æ¨¡æ¿ä¸æœç´¢æ¨¡æ¿åŒ¹é…è®°å½•å·²æ¸…é™¤'
        })
    });

    function localMb(local){//æœ¬åœ°æ¨¡æ¿
        // local: ä¸€çº§æ¨¡æ¿,äºŒçº§æ¨¡æ¿,æœç´¢æ¨¡æ¿
        // writeFile(root+local+'.json',JSON.stringify(inner));
        // return inner
        var root = 'hiker://files/rules/dzHouse/json/'; //æ¨¡æ¿æ ¹ç›®å½•
        let code = fetch(root+local+'.json')||'[]';
        try {
            return JSON.parse(code);
        }catch (e) {
            log(`æœ¬åœ°${local}:${root+local+'.json'}æœ‰è¯¯:`+e.message);
            log(code);
            return []
        }
    }
    d.push({
        title:"æŒ‡å®šä¸€çº§æ¨¡æ¿",
        col_type:col_type,
        url:$('#noLoading#').lazyRule((localMb)=>{
            let now = JSON.parse(getMyVar('yjmuban','{}')).åç§°||false;
            log('å½“å‰ä¸€çº§æ¨¡æ¿:'+now);
            let sel = localMb('ä¸€çº§æ¨¡æ¿').map(it=>now&&it.åç§°===now?'ğŸ‘‰'+it.åç§°:it.åç§°);
            return $(sel,2,'è¯·æŒ‡å®šä¸€ä¸ªä¸€çº§æ¨¡æ¿').select(()=>{
                input = input.replace(/ğŸ‘‰/g,'');
                // log(input);
                putMyVar('yjmuban',JSON.stringify({åç§°:input})); //åŒ¹é…æˆåŠŸä¿å­˜ä¸Šæ¬¡åŒ¹é…çš„æ¨¡æ¿,ä¸‹æ¬¡åŒ¹é…ç›´æ¥æ’ç¬¬ä¸€ä¸ª
                refreshPage(false);
                return 'hiker://empty'
            })
        },localMb)
    });
    d.push({
        title:"æŒ‡å®šäºŒçº§æ¨¡æ¿",
        col_type:col_type,
        url:$('#noLoading#').lazyRule((localMb)=>{
            let now = JSON.parse(getMyVar('muban','{}')).åç§°||false;
            log('å½“å‰äºŒçº§æ¨¡æ¿:'+now);
            let sel = localMb('äºŒçº§æ¨¡æ¿').map(it=>now&&it.åç§°===now?'ğŸ‘‰'+it.åç§°:it.åç§°);
            return $(sel,2,'è¯·æŒ‡å®šä¸€ä¸ªäºŒçº§æ¨¡æ¿').select(()=>{
                input = input.replace(/ğŸ‘‰/g,'');
                // log(input);
                putMyVar('muban',JSON.stringify({åç§°:input})); //åŒ¹é…æˆåŠŸä¿å­˜ä¸Šæ¬¡åŒ¹é…çš„æ¨¡æ¿,ä¸‹æ¬¡åŒ¹é…ç›´æ¥æ’ç¬¬ä¸€ä¸ª
                refreshPage(false);
                return 'hiker://empty'
            })
        },localMb)
    });
    d.push({
        title:"æŒ‡å®šæœç´¢æ¨¡æ¿",
        col_type:col_type,
        url:$('#noLoading#').lazyRule((localMb)=>{
            let now = JSON.parse(getMyVar('ssmuban','{}')).åç§°||false;
            log('å½“å‰æœç´¢æ¨¡æ¿:'+now);
            let sel = localMb('æœç´¢æ¨¡æ¿').map(it=>now&&it.åç§°===now?'ğŸ‘‰'+it.åç§°:it.åç§°);
            return $(sel,2,'è¯·æŒ‡å®šä¸€ä¸ªæœç´¢æ¨¡æ¿').select(()=>{
                input = input.replace(/ğŸ‘‰/g,'');
                // log(input);
                putMyVar('ssmuban',JSON.stringify({åç§°:input})); //åŒ¹é…æˆåŠŸä¿å­˜ä¸Šæ¬¡åŒ¹é…çš„æ¨¡æ¿,ä¸‹æ¬¡åŒ¹é…ç›´æ¥æ’ç¬¬ä¸€ä¸ª
                refreshPage(false);
                return 'hiker://empty'
            })
        },localMb)
    });
    let nextMode = lsg.getItem('dr_mode','WEB')==='WEB'?'APP':'WEB';
    d.push({
        title:'æ¨¡å¼:'+color(lsg.getItem('dr_mode','WEB'),'#1aad19'),
        col_type: col_type,
        url:$('#noLoading#').lazyRule((nextMode)=>{
            return $(`åˆ‡æ¢ä¸€çº§åŒ¹é…æ¨¡å¼ä¸º${nextMode}?`).confirm((nextMode)=>{
                require(getVar('drä¾èµ–'));
                lsg.setItem('dr_mode',nextMode);
                refreshPage(false);
                return 'hiker://empty'
            },nextMode)
        },nextMode)
    });
    return d
}

function è®¾ç½®(d,end){
    end = end||false;
    if(typeof(page)==='undefined'||!page){
        page = MY_PAGE||1;
    }
    if(parseInt(page)===1) {
        if(!getMyVar('æ˜¯å¦è¿›å…¥è§„åˆ™','')){
            try {
                eval(fetch(version.jsRoot+'æ›´æ–°.js',{timeout:2000}));
                let jsUpdate = new Date(updateT).getTime();
                // ä¾èµ–æ›´æ–°æ—¶é—´é»˜è®¤ä¸ºå½“å‰å‡å»ä¸€å¤©
                let localDate = lsg.getItem('drä¾èµ–æ›´æ–°æ—¶é—´',''+(new Date().getTime()-3600*24*1000));
                // if(parseInt(jsUpdate)!==parseInt(localDate)){
                if(parseInt(jsUpdate)>parseInt(localDate)){
                    log('äº‘ç«¯ä¾èµ–æ›´æ–°æ—¶é—´:'+jsUpdate+'\n,æœ¬åœ°ä¾èµ–æ›´æ–°æ—¶é—´:'+localDate);
                    confirm({
                        title:'æ›´æ–°å®Œæ¯•',
                        // content:'å·²è‡ªåŠ¨æ›´æ–°ä¾èµ–\næœ¬åœ°ä¾èµ–æ—¶é—´:'+new Date(parseInt(localDate)).toLocaleString()+'\näº‘ç«¯æœ€æ–°æ—¶é—´:'+new Date(jsUpdate).toLocaleString(),
                        content:'å·²è‡ªåŠ¨æ›´æ–°ä¾èµ–\næœ¬åœ°ä¾èµ–æ—¶é—´:'+$.dateFormat(new Date(parseInt(localDate)),"yyyy-MM-dd HH:mm:ss")+'\näº‘ç«¯æœ€æ–°æ—¶é—´:'+$.dateFormat(new Date(jsUpdate),"yyyy-MM-dd HH:mm:ss"),
                    });
                    try {
                        æ›´æ–°ä¾èµ–();
                        lsg.setItem('drä¾èµ–æ›´æ–°æ—¶é—´',''+jsUpdate);
                        refreshPage(true);
                    }catch (e) {}
                }
            }catch (e) {
                //confirm({title:'æç¤º',content:e.message})
                log(new Date().toLocaleString()+'æ£€æµ‹æ›´æ–°é”™è¯¯,å¯èƒ½æ˜¯è¶…æ—¶è¿”å›äº†ç©ºæºç :'+e.message)
            }
        }
        putMyVar('æ˜¯å¦è¿›å…¥è§„åˆ™','æ˜¯');
        let settings = {
            title: 'âš™ï¸è®¾ç½®',
            col_type: 'scroll_button',
            url: $().rule((color,htmlTag,blank) => {
                try {
                    require(getVar('drä¾èµ–'));
                }catch (e) {
                    setResult([{
                        title:e.message,
                        col_type:'long_text',
                        url:'hiker://empty'
                    }]);
                }
                function small(text) {
                    return htmlTag("small", text);
                }
                let d = [];
                addListener('onClose', $.toString(()=>{
                    // refreshPage(false); //è¿”å›è‡ªåŠ¨åˆ·æ–°ä½¿è®¾ç½®ç”Ÿæ•ˆ
                }));
                d.push({
                    title: 'å°ç¨‹åºä¸ªæ€§åŒ–è®¾ç½® '+blank()+small(color('å¸®åŠ©','#0048ff')),
                    desc: 'dræ¨¡æ¿(é“é•¿å¤šåŠŸèƒ½æ¨¡æ¿+rebornåŠ¨æ€åˆ†ç±»)\nå½±è§†/æ¼«ç”»/å¬ä¹¦/å°è¯´/å›¾ç‰‡/éšæœºå°å§å§',
                    col_type: 'text_1',
                    url: $().rule(()=>{
                        setPageTitle('å½±æ¼«æ¨¡æ¿å¥—å¨ƒå¸®åŠ©');
                        require(config['æ¨¡æ¿']);
                        require("http://hiker.nokia.press/hikerule/rulelist.json?id=3187");//mdæ’ä»¶
                        let d = [];
                        // let help = fetch(version.jsRoot+'å¸®åŠ©.html');
                        let help = "#### è·å–å¸®åŠ©å¤±è´¥,è¯·æ£€æŸ¥ç½‘ç»œ";
                        try {
                            help = fetch(version.jsRoot+'dr_help.md');
                        }catch (e) {}
                        d.push({
                            title:'<h4>æ›´æ–°æ—¥å¿—:</h4><div>'+version.info.replace('\n','<br>')+'</div>',
                            col_type:'rich_text'
                        });
                        d.push({
                            // title:help,
                            title:marked.parse(help),
                            col_type:'rich_text'
                        });
                        setResult(d);
                    })
                });
                let all_cols = [''].concat(getColTypes());
                // ['','text_2','text_3','text_4','text_5','flex_button']
                let æŒ‰é’®æ ·å¼ = all_cols.map((it) => {
                    return it === (lsg.getItem('æŒ‰é’®æ ·å¼', '')||'') ? 'ğŸ‘‰' + it : it;
                });
                d.push({
                    title: 'é€‰é›†æŒ‰é’®æ ·å¼:' + (lsg.getItem('æŒ‰é’®æ ·å¼', '')||''),
                    col_type: 'text_1',
                    url: $(æŒ‰é’®æ ·å¼, 2, 'è¯·é€‰æ‹©é€‰é›†æŒ‰é’®æ ·å¼').select(() => {
                        require(getVar('drä¾èµ–'));
                        input = input.replace(/ğŸ‘‰/g, '');
                        lsg.setItem('æŒ‰é’®æ ·å¼', input);
                        refreshPage(true);
                        return 'toast://å·²åˆ‡æ¢é€‰é›†æŒ‰é’®æ ·å¼ä¸º:' + input;
                    })
                });

                let zdcs = 'â€œâ€œâ€â€<b><span style="color: #FF0000">âˆ¨</span></b>';
                let zdcss = lsg.getItem('æŠ˜å æ ·å¼',zdcs)||zdcs;
                d.push({
                    title:'åŠ¨æ€åˆ†ç±»æŠ˜å æŒ‰é’®æ ·å¼:'+zdcss,
                    col_type:'text_1',
                    url:$(zdcss).input(()=>{
                        require(getVar('drä¾èµ–'));
                        lsg.setItem('æŠ˜å æ ·å¼',input);
                        refreshPage(false);
                        return 'hiker://empty'
                    })
                });
                let zkcs='â€œâ€œâ€â€<b><span style="color: #1aad19">âˆ§</span></b>';
                let zkcssd = lsg.getItem('å±•å¼€æ ·å¼',zkcs)||zkcs;
                d.push({
                    title:'åŠ¨æ€åˆ†ç±»å±•å¼€æŒ‰é’®æ ·å¼:'+zkcssd,
                    col_type:'text_1',
                    url:$(zkcssd).input(()=>{
                        require(getVar('drä¾èµ–'));
                        lsg.setItem('å±•å¼€æ ·å¼',input);
                        refreshPage(false);
                        return 'hiker://empty'
                    }),
                    extra:{
                        lineVisible:false
                    }
                });
                d = d.concat(åŒ¹é…è®¾ç½®());
                let catecolor = '#1aad19';
                catecolor = (lsg.getItem('åˆ†ç±»é¢œè‰²',catecolor)||catecolor);
                d.push({
                    title:'åˆ†ç±»é¢œè‰²:'+color(catecolor,catecolor),
                    col_type:'text_2',
                    url:$(catecolor).input(()=>{
                        require(getVar('drä¾èµ–'));
                        lsg.setItem('åˆ†ç±»é¢œè‰²',input);
                        refreshPage(false);
                        return 'toast://å·²è®¾ç½®åˆ†ç±»æŒ‰é’®é¢œè‰²ä¸º:'+input
                    })
                });
                let jjwords = '100';
                d.push({
                    title:'ç®€ä»‹å­—æ•°:'+color(lsg.getItem('ç®€ä»‹å­—æ•°',jjwords),'#ff7000'),
                    col_type:'text_2',
                    url:$(jjwords).input(()=>{
                        if(!parseInt(input)||parseInt(input)<=0){
                            return 'toast://è¯·è®¾ç½®å­—æ•°å¿…é¡»å¤§äº0'
                        }
                        require(getVar('drä¾èµ–'));
                        lsg.setItem('ç®€ä»‹å­—æ•°',input);
                        refreshPage(false);
                        return 'toast://å·²è®¾ç½®ç®€ä»‹å­—æ•°ä¸º:'+input
                    })
                });

                let æ¨¡æ¿æ ·å¼ = ['æ»šåŠ¨', 'é»˜è®¤'].map((it) => {
                    return it === lsg.getItem('æ ·å¼', 'æ»šåŠ¨') ? 'ğŸ‘‰' + it : it;
                });
                d.push({
                    title: 'æ ·å¼:' + lsg.getItem('æ ·å¼', 'æ»šåŠ¨'),
                    col_type: 'text_3',
                    url: $(æ¨¡æ¿æ ·å¼, 2, 'è¯·é€‰æ‹©æ¨¡æ¿æ ·å¼').select(() => {
                        require(getVar('drä¾èµ–'));
                        input = input.replace(/ğŸ‘‰/g, '');
                        lsg.setItem('æ ·å¼', input);
                        refreshPage(true);
                        return 'toast://å·²åˆ‡æ¢æ¨¡æ¿æ ·å¼ä¸º:' + input;
                    })
                });

                d.push({
                    title:"é€šå…:"+color(lsg.getItem("é€šå…","WEB"),"#ff7000"),
                    col_type:"text_3",
                    url:$('#noLoading#').lazyRule(()=>{
                        require(getVar('drä¾èµ–'));
                        if(lsg.getItem("é€šå…","X5")==="X5"){
                            lsg.setItem("é€šå…","WEB");
                        }else{
                            lsg.setItem("é€šå…","X5");
                        }
                        refreshPage(false);
                        return "toast://å·²è®¾ç½®ä»“åº“é€šå…æ¨¡å¼ä¸º:"+lsg.getItem("é€šå…");
                    })
                });

                d.push({
                    title:"è¶…æ—¶:"+color(lsg.getItem("timeout","5000"),"#ff7000"),
                    col_type:"text_3",
                    url:$(lsg.getItem("timeout","5000"),'è¯·è¾“å…¥é€šå…è¶…æ—¶æ¯«ç§’æ•°').input(()=>{
                        require(getVar('drä¾èµ–'));
                        if(Number(input)){
                            lsg.setItem("timeout",input);
                            refreshPage(false);
                            return "toast://å·²è®¾ç½®ä»“åº“é€šå…è¶…æ—¶æ—¶é—´ä¸º:"+lsg.getItem("timeout");
                        }else{
                            return "toast://è¶…æ—¶è®¾ç½®ä¸åˆç†,å¿…é¡»ä¸ºæ•´æ•°ã€‚æ¨è5000~15000";
                        }
                    })
                });

                let ua = ['ç”µè„‘', 'æ‰‹æœº'].map((it) => {
                    return it === (lsg.getItem('ua', 'ç”µè„‘')||'ç”µè„‘') ? 'ğŸ‘‰' + it : it;
                });
                d.push({
                    title: 'å…¨å±€UA:' + (lsg.getItem('ua', 'ç”µè„‘')||'ç”µè„‘'),
                    col_type: 'text_2',
                    url: $(ua, 2, 'è¯·é€‰æ‹©å…¨å±€UA').select(() => {
                        require(getVar('drä¾èµ–'));
                        input = input.replace(/ğŸ‘‰/g, '');
                        lsg.setItem('ua', input);
                        refreshPage(true);
                        return 'toast://å·²åˆ‡æ¢å…¨å±€UAä¸º:' + input;
                    })
                });
                let åˆ†éš”ç¬¦ = ['åŒç©ºæ ¼', 'æ¢è¡Œç¬¦'].map((it) => {
                    return it === (lsg.getItem('åˆ†éš”ç¬¦', 'æ¢è¡Œç¬¦')||'æ¢è¡Œç¬¦') ? 'ğŸ‘‰' + it : it;
                });
                d.push({
                    title: 'åˆ†éš”ç¬¦:' + (lsg.getItem('åˆ†éš”ç¬¦','æ¢è¡Œç¬¦')||'æ¢è¡Œç¬¦'),
                    col_type: 'text_2',
                    url: $(åˆ†éš”ç¬¦, 2, 'è¯·é€‰æ‹©åˆ†éš”ç¬¦').select(() => {
                        require(getVar('drä¾èµ–'));
                        input = input.replace(/ğŸ‘‰/g, '');
                        lsg.setItem('åˆ†éš”ç¬¦', input);
                        refreshPage(true);
                        return 'toast://å·²åˆ‡æ¢åˆ†éš”ç¬¦ä¸º:' + input;
                    })
                });

                d.push({
                    title:'æ¸…é™¤å·²é€‰åŠ¨æ€åˆ†ç±»',
                    col_type:'text_2',
                    url:$('å› å¼€å‘è€…æœªè¿‡æ»¤é”™è¯¯åˆ†ç±»å¯¼è‡´åˆ‡æ¢åˆ°è¯¥åˆ†ç±»åæºç å…¨ä¸¢,å¯é€šè¿‡æ­¤æŒ‰é’®é‡ç½®ï¼Œæ˜¯å¦ç»§ç»­?').confirm(()=>{
                        clearMyVar('header.url');
                        clearMyVar('header.category');
                        // clearMyVar('header.fold');
                        return 'toast://å·²æ¸…é™¤'
                    })
                });
                d.push({
                    title:'æ¸…é™¤cookie',
                    col_type:'text_2',
                    url:$('å¼€å‘è€…ç”¨äºæµ‹è¯•æ˜¯å¦æˆåŠŸè¿‡ç½‘ç«™éªŒè¯çš„å¥½å¸®æ‰‹,æ¸…é™¤åéœ€è¦é‡æ–°éªŒè¯ï¼Œç»§ç»­?').confirm(()=>{
                        clearMyVar('cookie');
                        clearMyVar('è¯·æ±‚å¤´');
                        return 'toast://å·²æ¸…é™¤cookieåŠè¯·æ±‚å¤´'
                    })
                });
                d.push({
                    title:'ç¿»é¡µé˜€å€¼:'+color(lsg.getItem('ç¿»é¡µé˜€å€¼',40),'#d96715'),
                    col_type:'text_2',
                    url:$(lsg.getItem('ç¿»é¡µé˜€å€¼',40),'æœ€ä½æŒ‡å®šçº¿è·¯é€‰é›†æ€»æ•°è¶…è¿‡æ­¤å€¼æ‰ä¼šæ˜¾ç¤ºç¿»é¡µå…ƒç´ ').input(()=>{
                        if(isNaN(parseInt(input))){
                            return 'toast://æ»šçŠŠå­å§,è¾“å…¥çš„éƒ½ä¸æ˜¯æ•°å­—'
                        }
                        let num = parseInt(input);
                        if(num<40){
                            return 'toast://ä¸å¯ä»¥å°äº40ï¼Œè°¢è°¢'
                        }
                        require(getVar('drä¾èµ–'));
                        lsg.setItem('ç¿»é¡µé˜€å€¼',num+'');
                        refreshPage(false);
                        return 'toast://å·²ä¿å­˜'
                    })
                });
                d.push({
                    title:'æ¯é¡µæ•°é‡:'+color(lsg.getItem('æ¯é¡µæ•°é‡',40),'#d96715'),
                    col_type:'text_2',
                    url:$(lsg.getItem('æ¯é¡µæ•°é‡',40),'æ»¡è¶³é€‰é›†ç¿»é¡µæ¨¡å¼æ—¶æ¯é¡µæ˜¾ç¤ºé€‰é›†æ•°é‡').input(()=>{
                        if(isNaN(parseInt(input))){
                            return 'toast://æ»šçŠŠå­å§,è¾“å…¥çš„éƒ½ä¸æ˜¯æ•°å­—'
                        }
                        let num = parseInt(input);
                        if(num<40){
                            return 'toast://ä¸å¯ä»¥å°äº40ï¼Œè°¢è°¢'
                        }
                        require(getVar('drä¾èµ–'));
                        lsg.setItem('æ¯é¡µæ•°é‡',num+'');
                        refreshPage(false);
                        return 'toast://å·²ä¿å­˜'
                    })
                });
                d.push({
                    title:'æ¸…ç©ºç¿»é¡µè¶³è¿¹',
                    col_type:'text_3',
                    url:$('æ¸…é™¤æ‰€æœ‰drå°ç¨‹åºçš„äºŒçº§ç¿»é¡µè¶³è¿¹ï¼Œæ˜¯å¦ç»§ç»­?').confirm(()=>{
                        require(getVar('drä¾èµ–'));
                        lsg.removeItem('footHistory'); //ç§»é™¤è¶³è¿¹
                        refreshPage(false);
                        return 'toast://å·²æ¸…é™¤è¶³è¿¹'
                    })
                });
                d.push({
                    title:'æ¢å¤å‡ºå‚è®¾ç½®',
                    col_type:'text_3',
                    url:$('æ¢å¤æ‰€æœ‰è‡ªå®šä¹‰é…ç½®é¡¹ä¸ºé»˜è®¤ï¼Œæ˜¯å¦ç»§ç»­?').confirm((zkcs,zdcs)=>{
                        require(getVar('drä¾èµ–'));
                        clearMyVar('header.url');
                        lsg.clear(); //æ¸…é™¤æ‰€æœ‰
                        lsg.setItem('åˆ†ç±»é¢œè‰²','#1aad19');
                        lsg.setItem('å±•å¼€æ ·å¼',zkcs);
                        lsg.setItem('æŠ˜å æ ·å¼',zdcs);
                        lsg.setItem('åˆ†éš”ç¬¦', 'æ¢è¡Œç¬¦');
                        lsg.setItem('ua', 'ç”µè„‘');
                        lsg.setItem('æŒ‰é’®æ ·å¼', '');
                        lsg.setItem('æ ·å¼', 'æ»šåŠ¨');
                        // clearItem('dr_mode');
                        lsg.setItem('dr_mode','WEB');
                        // lsg.removeItem('footHistory');
                        refreshPage(false);
                        return 'toast://å·²æ¢å¤'
                    },zkcs,zdcs)
                });
                d.push((new åŒ¹é…è®¾ç½®('text_3')).slice(-1)[0]);//å°†åŒ¹é…çš„æ¨¡å¼åˆ‡æ¢æœ€åä¸€ä¸ªæ”¾è¿›å»
                d.push({
                    title: 'ğŸ”™è¿”å›å¹¶åˆ·æ–°ç”Ÿæ•ˆ',
                    desc:'ä¸ºèŠ‚çœæ€§èƒ½ï¼Œç›´æ¥ç‚¹å·¦ä¸Šè§’è¿”å›ä¸ä¼šåˆ·æ–°å’Œç”Ÿæ•ˆ',
                    col_type: 'text_1',
                    url: $('#noLoading#').lazyRule(() => {
                        clearMyVar('æ˜¯å¦è¿›å…¥è§„åˆ™');
                        back(true)
                        return 'hiker://empty'
                    })
                });
                d.push({
                    title: 'â™»æ¸…é™¤ä¾èµ–å¹¶è¿”å›å‡çº§',
                    desc:'æ¸…é™¤æ‰€æœ‰drä¾èµ–,ç­‰åŒäºé•¿æŒ‰å°ç¨‹åºæ ‡é¢˜æ¸…é™¤ç¼“å­˜',
                    col_type: 'text_1',
                    url: $('ç¡®è®¤æ¸…é™¤æ‰€æœ‰drç³»åˆ—å°ç¨‹åºçš„ç¼“å­˜ä¾èµ–å—?').confirm(() => {
                        deleteCache();
                        clearMyVar('æ˜¯å¦è¿›å…¥è§„åˆ™');
                        back(true)
                        return 'toast://æ¨¡å—ä¾èµ–ç¼“å­˜å·²æ¸…é™¤'
                    })
                });
                setResult(d);
            },color,htmlTag,blank)
        };
        if(!end){
            d.unshift(settings)
        }else{
            d.splice(-1, 0, settings);
        }
    }
}
function å¼•å…¥åŠ¨æ€åˆ†ç±»(){
    initConfig({
        categoryLib: 'http://hiker.nokia.press/hikerule/rulelist.json?id=2705',
        categoryLocalLib: 'hiker://files/rules/js/categories-header.js',
        categoryGiteeLib: 'https://gitee.com/reborn0/HikerRules/raw/master/plugins/categories-header.js',
        categoryCodeBergLib: version.jsRoot+'categories-header.js',
        UrlProcessorLib: 'http://hiker.nokia.press/hikerule/rulelist.json?id=2849',
        UrlProcessorLocalLib: 'hiker://files/rules/js/UrlProcessor.js',
        UrlProcessorGiteeLib: 'https://gitee.com/reborn0/HikerRules/raw/master/plugins/UrlProcessor.js',
        åŠ¨æ€åˆ†ç±»åŒ¹é…:'hiker://files/rules/js/åŠ¨æ€åˆ†ç±»åŒ¹é….js',
        // è‡ªåŠ¨åŒ¹é…:'https://gitlab.com/hjdhnx/hiker/-/raw/main/js/è‡ªåŠ¨æ¨¡æ¿åŒ¹é….js',
        è‡ªåŠ¨åŒ¹é…:version.jsRoot+'è‡ªåŠ¨æ¨¡æ¿åŒ¹é….js',
        é€šå…:version.jsRoot+'lazy.js',
        ui:version.jsRoot+'hikerUi.js',//drå¢åŠ ç»„ä»¶åº“,å¯å†™jsonç±»æ•°æ®
    });
}
function åŠ¨æ€åˆ†ç±»(d){//å¦ä¸€å¥—åŠ¨æ€åˆ†ç±»å†™æ³•
    const empty = "hiker://empty"

    try {
        var categories = pdfa(html, å¤§ç±»å®šä½).concat(pdfa(html, æ‹¼æ¥åˆ†ç±»))
    } catch (e) {
        var categories = pdfa(html, å¤§ç±»å®šä½)
    }

    let init_cate = []

    for (let i = 0; i < 20; i++) {
        init_cate.push("0")
    }

    const fold = getMyVar('header.fold', "0")
    const cate_temp_json = getMyVar('header.category', JSON.stringify(init_cate))
    const cate_temp = JSON.parse(cate_temp_json)

    if (parseInt(MY_PAGE) === 1) {
        d.push({
            title: fold === '1' ? 'â€œâ€œâ€â€<b><span style="color: #FF0000">âˆ¨</span></b>' : 'â€œâ€œâ€â€<b><span style="color: #1aad19">âˆ§</span></b>',
            url: $('#noLoading#').lazyRule((fold) => {
                putMyVar('header.fold', fold === '1' ? '0' : '1');
                refreshPage(false);
                return "hiker://empty"
            }, fold),
            col_type: 'scroll_button',
        })


        categories.forEach((category, index) => {
            let sub_categories = pdfa(category, å°ç±»å®šä½);
            if (index === 0) {
                sub_categories.forEach((item, key) => {
                    let title = pdfh(item, åˆ†ç±»æ ‡é¢˜)
                    d.push({
                        title: key.toString() === cate_temp[index] ? 'â€œâ€œâ€â€<b><span style="color: ' + åˆ†ç±»é¢œè‰² + '">' + title + '</span></b>' : title,
                        url: $(pd(item, åˆ†ç±»é“¾æ¥) + '#noLoading#').lazyRule((params) => {
                            let new_cate = []
                            params.cate_temp.forEach((cate, index) => {
                                new_cate.push(index === 0 ? params.key.toString() : "0")
                            })
                            putMyVar('header.category', JSON.stringify(new_cate))
                            putMyVar('header.url', input)
                            refreshPage(true)
                            return "hiker://empty"
                        }, {
                            cate_temp: cate_temp,
                            key: key,
                            page: page,
                        }),
                        col_type: 'scroll_button',
                    })
                })
                d.push({
                    col_type: "blank_block"
                });
            } else if (fold === '1') {
                sub_categories.forEach((item, key) => {
                    let title = pdfh(item, åˆ†ç±»æ ‡é¢˜)
                    d.push({
                        title: key.toString() === cate_temp[index] ? 'â€œâ€œâ€â€<b><span style="color: ' + åˆ†ç±»é¢œè‰² + '">' + title + '</span></b>' : title,
                        url: $(pd(item, åˆ†ç±»é“¾æ¥) + '#noLoading#').lazyRule((params) => {
                            params.cate_temp[params.index] = params.key.toString()

                            putMyVar('header.category', JSON.stringify(params.cate_temp))
                            putMyVar('header.url', input)
                            refreshPage(true)
                            return "hiker://empty"
                        }, {
                            cate_temp: cate_temp,
                            index: index,
                            key: key,
                            page: page,
                        }),
                        col_type: 'scroll_button',
                    })
                })
                d.push({
                    col_type: "blank_block"
                });
            }
        })
    }
    return d
}

function é¦™å…(){//é¦™ä½¬é€šå…
    require(config.é€šå…||version.jsRoot+'lazy.js');
}

function æ··åˆ(fn,detailUrl,system,web_url){//æ··åˆä¸€çº§
    if(typeof(system)==='undefined'){
        system = true; // å¦‚æœä¸ä¼ å°±ä¸è¦æ‹¦æˆªè®¾ç½®
    }
    web_url = web_url||false;
    if(lsg.getItem('dr_mode','WEB')==='APP'){
        refreshX5Desc('float&&0');
        refreshX5WebView('http://127.0.0.1:4848');//å¼ºåˆ¶é€€å‡ºx5
        var page = MY_PAGE;
        fn(); // æ‰§è¡Œæ··åˆå‡½æ•°,æ··åˆå‡½æ•°ä¸€èˆ¬æ˜¯ä¸‹é¢è¿™ç§è‡ªåŠ¨ä¸€çº§å‡½æ•°
        /*
        true_url = è·å–æ­£ç¡®é“¾æ¥();
        let cates = æ‰“é€ åŠ¨æ€åˆ†ç±»([]);
        è®¾ç½®(cates);
        è‡ªåŠ¨ä¸€çº§(null,null,cates);
         */
    }else{
        ä¾èµ–æ£€æµ‹();
        // ä¸€çº§ä¹¦ç­¾('$detailUrl','$system');
        if(web_url){
            MY_URL = web_url.startsWith('http')?web_url:getHome(MY_URL.replace('hiker://empty##',''))+web_url
        }
        ä¸€çº§ä¹¦ç­¾(detailUrl||'detail',system);
    }
}

function åŠ è½½åŠ¨æ€åˆ†ç±»(mode){
    // æ¨¡å¼ä¸å¡«å°±æ˜¯gitee,1æœ¬åœ°ï¼Œ2ä»“åº“,åªèƒ½åœ¨ä¸€çº§é‡Œç”¨æ­¤æ–¹æ³•ï¼Œå¹¶ä¸”é¢„å¤„ç†å¿…é¡»å…ˆåŠ è½½
    var jsUrl;
    switch (mode) {
        case 0:
            jsUrl = config.categoryGiteeLib
        case 1:
            jsUrl = config.categoryLocalLib
            break;
        case 2:
            jsUrl = config.categoryLib
            break;
        default:
            jsUrl = config.categoryCodeBergLib
    }
    let htmlCategories=require(jsUrl);
    return htmlCategories; //è¿”å›åŠ¨æ€åˆ†ç±»å¯¹è±¡
}

function åŠ è½½é“¾æ¥å¤„ç†(mode){
    var jsUrl;
    switch (mode) {
        case 0:
            jsUrl = config.UrlProcessorGiteeLib
        case 1:
            jsUrl = config.UrlProcessorLocalLib
            break;
        case 2:
            jsUrl = config.UrlProcessorLib
            break;
        default:
            jsUrl = config.UrlProcessorLib
    }
    let é“¾æ¥å¤„ç†å·¥å…·=require(jsUrl);
    return é“¾æ¥å¤„ç†å·¥å…·; //è¿”å›é“¾æ¥å¤„ç†å·¥å…·å¯¹è±¡
}

function åŠ è½½é­”æ–­(){
    // let tools = åŠ è½½é­”æ–­() tools.renrenmi
    return require('http://hiker.nokia.press/hikerule/rulelist.json?id=2971');
}

function æ‰“é€ åŠ¨æ€åˆ†ç±»(å®šä½åˆ—è¡¨,extra){
    let cates=[];
    if((Array.isArray(å®šä½åˆ—è¡¨)&&å®šä½åˆ—è¡¨.length<1)||!Array.isArray(å®šä½åˆ—è¡¨)){
        return cates
    } else if(Array.isArray(å®šä½åˆ—è¡¨)&&å®šä½åˆ—è¡¨.length>0&&!å®šä½åˆ—è¡¨[0].ä¸€çº§åˆ†ç±»){//ä¸€çº§åˆ†ç±»ä¸ºç©ºä¹Ÿè¿”å›ç©º
        return cates
    }
    extra = extra||{};
    // log('htmlç±»å‹:'+typeof(html));
    å•æ¬¡è¯·æ±‚ = extra.å•æ¬¡è¯·æ±‚||false;
    åˆ†ç±»é¢œè‰² = extra.åˆ†ç±»é¢œè‰²||(lsg.getItem('åˆ†ç±»é¢œè‰²','#1aad19')||'#1aad19');
    æºç  = extra.æºç ||'';
    æŠ˜å  = extra.å…³é—­æŠ˜å ||'';
    æ¨¡å¼ = extra.æ¨¡å¼||'';
    if(æŠ˜å !==''){
        å…³é—­æŠ˜å  = !!æŠ˜å ;
    }else {
        å…³é—­æŠ˜å  = typeof (å…³é—­æŠ˜å ) === 'undefined' ? false : å…³é—­æŠ˜å ;
    }
    // let ua = config.ua==='æ‰‹æœº'?MOBILE_UA:PC_UA;
    if(æºç ) {
        html = æºç ;
    }else{
        // html = (typeof (html) === 'undefined' || !html) ? (å•æ¬¡è¯·æ±‚ ? getResCode() : è·å–æºç (true_url, ua)) : html;//å…¨å±€å˜é‡,å¤–éƒ¨ä¼ è¿›æ¥çš„
        html = (typeof (html) === 'undefined' || !html) ? (å•æ¬¡è¯·æ±‚ ? getResCode() : è·å–æºç (true_url)) : html;//å…¨å±€å˜é‡,å¤–éƒ¨ä¼ è¿›æ¥çš„
    }
    const å½“å‰æŠ˜å çŠ¶æ€ = getMyVar('header.fold', '1');
    let åŠ¨æ€åˆ†ç±»=åŠ è½½åŠ¨æ€åˆ†ç±»(æ¨¡å¼); //1æœ¬åœ° 2ä»“åº“ å…¶å®ƒgitee
    let drzd = 'â€œâ€œâ€â€<b><span style="color: #FF0000">âˆ¨</span></b>';
    let drzk = 'â€œâ€œâ€â€<b><span style="color: #1aad19">âˆ§</span></b>';
    åŠ¨æ€åˆ†ç±».ç•Œé¢(cates)
        .åˆ†ç±»é“¾æ¥(true_url)
        .é€‰ä¸­çš„åˆ†ç±»é¢œè‰²(åˆ†ç±»é¢œè‰²)
        .æºç (html)
        .é¡µç (page)
        .æ·»åŠ åˆ†ç±»å®šä½(å®šä½åˆ—è¡¨)
    if(!å…³é—­æŠ˜å ){
        åŠ¨æ€åˆ†ç±».å¼€å¯å†…ç½®æŠ˜å åŠŸèƒ½() // å¿…é¡»
            .æŠ˜å æŒ‰é’®æ ·å¼({ title: å½“å‰æŠ˜å çŠ¶æ€==="1"?(lsg.getItem('æŠ˜å æ ·å¼',drzd)||drzd):(lsg.getItem('å±•å¼€æ ·å¼',drzk)||drzk) }) // å¯é€‰
            .ç¬¬å‡ è¡Œå¼€å§‹æŠ˜å (1) // å¯é€‰
            .æŠ˜å æŒ‰é’®æ ·å¼({ æŠ˜å æŒ‰é’®æ’å…¥è¡Œ: 1 })
            .æŠ˜å (å½“å‰æŠ˜å çŠ¶æ€)  // å¿…é¡»
    }
    åŠ¨æ€åˆ†ç±».å¼€å§‹æ‰“é€ åˆ†ç±»();
    return cates
}

function è·å–æ­£ç¡®é“¾æ¥(rule,url,è°ƒè¯•){
    true_url = (typeof(true_url)!=='undefined'&&true_url)?true_url:getMyVar('header.url', MY_URL); //éšå£«å…¨å±€å˜é‡ï¼Œå¤–é¢å¯ä»¥ä¸ä¼ 
    page = (typeof(page)!=='undefined'&&page)?page:MY_PAGE;
    // config.åŠ¨æ€åˆ†ç±»åŒ¹é…
    rule = rule||[];
    url = url||'';
    è°ƒè¯• = è°ƒè¯•||false;
    if(url.startsWith('hiker://')){
        try {
            let code = fetch(url);
            eval(code);
            if (rule.constructor === Array) {
                rule = rule.concat(matches);
            } else {
                matches.unshift(rule);
                rule = matches;
            }
        }catch (e) {}
    }
    // log($.stringify(rule));
    let é“¾æ¥å¤„ç†å·¥å…· = åŠ è½½é“¾æ¥å¤„ç†();
    if(è°ƒè¯•===true){
        é“¾æ¥å¤„ç†å·¥å…·.debug();
    }
    true_url = é“¾æ¥å¤„ç†å·¥å…·
        .é“¾æ¥(true_url)
        .é¡µç (page)
        .æ’å…¥æ–°å¤„ç†è§„åˆ™(rule)
        .è·å–å¤„ç†ç»“æœ();
    return true_url
}

function è·å–æœç´¢é“¾æ¥(){
    if(MY_URL.startsWith('hiker://empty##')){
        var api = MY_RULE.url.replace('hiker://empty##','').split('#')[0].split('?')[0];
        var host = getHome(api); // è·å–åŸŸå
        var sapi = MY_URL.replace("hiker://empty##","");//æœç´¢æ¥å£
        MY_URL=sapi.startsWith('http')?sapi:host+sapi;//çœ‹æœç´¢æ¥å£æ˜¯ä¸æ˜¯å®Œæ•´é“¾æ¥
    }
    log('æœç´¢é“¾æ¥:'+MY_URL);
    return MY_URL
}

function è·å–æºç (url,ua,referer,cookie,extrHeaders){//ä¼ url,uaå’Œrefer
    url = url.replace('hiker://empty##','');//è·å–æºç è‡ªåŠ¨å»é™¤å ä½çš„å‰ç¼€
    let def_ua = config.ua==='æ‰‹æœº'?MOBILE_UA:PC_UA;
    def_ua = config.æŒ‡å®šua?config.æŒ‡å®šua:def_ua;//å¦‚æœä¼ äº†æŒ‡å®šuaç»™é¢„å¤„ç†,ä¼˜å…ˆçº§æ›´é«˜,å¿…é¡»æ˜¯uaå­—ç¬¦ä¸²
    ua = ua||def_ua;
    extrHeaders = extrHeaders||{};
    let headers = {
        'User-Agent': ua
    };
    if(typeof(referer)!=='undefined'&&referer.length>4){
        headers.Referer = referer
    }
    if(typeof(cookie)!=='undefined'&&cookie.length>4){
        headers.Cookie = cookie
    }else{
        // è·å–æºç åœ¨æ¥å…¥ä¸‹è½½ç®¡ç†è·³åˆ°å…¶ä»–è§„åˆ™å­é¡µé¢å¯èƒ½ä¼šæ— æ³•è·å–ï¼Œéœ€è¦åœ¨è¿›å»çš„æ—¶å€™å¤„ç†
        if(getMyVar('cookie','')){
            headers.Cookie = getMyVar('cookie');
        }
    }
    try{
        Object.assign(headers, extrHeaders);//åˆå¹¶å…¶ä»–çš„è¯·æ±‚å¤´
        // log(headers);
        putMyVar('è¯·æ±‚å¤´',JSON.stringify(headers)); // æŠŠè¿™ä¸ªæ”¾è¿›å»,ä¸ºäº†åé¢æ–¹ä¾¿æ‰“å°çš„æ—¶å€™è¿›è¡Œè¯»å–
        let html = fetch(url, {
            headers: headers
        });
        if (/\?btwaf=/.test(html)) {//å®å¡”éªŒè¯
            url=url.split('#')[0]+'?btwaf'+html.match(/btwaf(.*?)\"/)[1];
            log("å®å¡”éªŒè¯è·³è½¬åˆ°:"+url);
            html = fetch(url, {
                headers: headers
            });
        }
        return html
    }catch(e){
        log('è·å–æºç å‡ºé”™'+e.message);
        return ''
    }
}
function åˆå§‹åˆ†ç±»é¡µ(parse,deal){
    if(!parse){
        setError('å‚æ•°ä¸€å¿…ä¼ ,ä¸ºåˆå§‹åˆ†ç±»é¡µé“¾æ¥çš„éƒ½å®šä½');
    }
    deal = deal||function (u){
        return u
    };
    //è¶…çº§åŠ¨æ€åˆ†ç±»ç¬¬ä¸€æ­¥ï¼Œè·å–åˆå§‹é¡µ
    if(!getMyVar('header.url','')){
        log('è¶…çº§åŠ¨æ€åˆ†ç±»ï¼Œè·å–åˆå§‹åˆ†ç±»é¡µ');
        var code=è·å–æºç (MY_URL);
        var url=pd(code,parse);
        if(typeof(deal)==='function'){
            url = deal(url)
        }
        putMyVar('header.url',url);
        log('åˆå§‹åˆ†ç±»é¡µé“¾æ¥ä¸º:'+url);
    }
}

function è·å–éªŒè¯ç (url,ua){ // éªŒè¯ç é“¾æ¥
    ua = ua||PC_UA;
    let ocr_api = 'http://ocr.nokia.press/dz6/api/ocr';
    let host = url.match(/(.*)\/\/(.*?)\//)[0];
    let headers = {
        'User-Agent': ua,
        'Referer':host,
        'Cookie':getMyVar('cookie'),
    };
    let hex=fetch(url,{headers:headers,toHex:true,timeout:3000});
    // log('hex:'+hex);
    let ret = request(ocr_api, {
        headers: {
            // 'content-type': 'application/json',
            'content-type': 'application/x-www-form-urlencoded',
        },
        // body: JSON.stringify(data),
        body: 'hex='+hex,
        method: 'POST'
    });
    try {
        ret = JSON.parse(ret).ret
    }catch (e) {}
    return ret
}

function æäº¤éªŒè¯ç (url,ua,method,body){
    ua = ua||PC_UA;
    method = method||'POST';
    body = body||'';
    let host = url.match(/(.*)\/\/(.*?)\//)[0];
    let headers = {
        'User-Agent': ua,
        'Referer':host,
        'Cookie':getMyVar('cookie'),
    };
    let params = {
        headers: headers,
        method: method,
        withHeaders:true
    };
    if(body){
        params.body = body
    }
    let cookie = JSON.parse(fetch(url, params));
    // log('éªŒè¯åhtml:'+cookie.body);
    return cookie.body
}

function åŠ¨æ€æºç (page,url){
    return {
        page:page,
        html:è·å–æºç (url)
    }
}
function æ˜¯å¦è§†é¢‘(input){//åˆ¤æ–­æ˜¯å¦è§†é¢‘ï¼Œå®ç°è‡ªåŠ¨åŠ UA
    const {isVideo} = $.require('hiker://page/globalParse?rule=é“é•¿ä»“åº“Pro');
    let realUrl = isVideo(input);
    if(realUrl&&!/User-Agent/.test(realUrl)){
        // realUrl = realUrl.split('#')[0]+';{User-Agent@Mozilla/5.0}';
        realUrl = realUrl+';{User-Agent@Mozilla/5.0}';
    }
    return realUrl;
}

function è·å–é“¾æ¥å‡½æ•°ç¤ºä¾‹(input){
    let html=fetch(input);
    let realUrl=html.match(/var player_aaaa=(.*?)url":"(.*?)",/)[2];
    realUrl=decodeURIComponent(realUrl);
    return realUrl
}
function æ˜¯å¦æ”¯æŒé­”æ–­(vipUrl,fromUrl){ // æ­£ç‰ˆåœ°å€,æ¥æºåœ°å€
    vipUrl = vipUrl||'';
    fromUrl = fromUrl||'';
    fromOk = typeof(fromUrl)==='string'?/bilibili|qiyi|youku|qq|sohu|mgtv|pptv|letv/.test(fromUrl):fromUrl;
    vipOk = /qq\.com|iqiyi\.com|youku\.com|mgtv\.com|bilibili\.com|sohu\.com|tv\.sohu\.com|ixigua\.com|pptv\.com|miguvideo\.com|le\.com|1905\.com|fun\.tv|renrenmi-|fendou\.duoduozy|LT|RongXingVR|1\.ruifenglb\.com|xfy|suoyo|leduo/.test(vipUrl);
    return fromOk&&vipOk
}

function æ˜¯å¦æ­£ç‰ˆ(vipUrl){
    vipUrl = vipUrl||'';
    let vipOk = /qq\.com|iqiyi\.com|youku\.com|mgtv\.com|bilibili\.com|sohu\.com|tv\.sohu\.com|ixigua\.com|pptv\.com|miguvideo\.com|le\.com|1905\.com|fun\.tv|renrenmi-|fendou\.duoduozy|LT|RongXingVR|1\.ruifenglb\.com|xfy|suoyo|leduo/.test(vipUrl);
    return vipOk
}

function çº¯é­”æ–­(vipUrl){
    eval("var configDp =" + fetch("hiker://files/cache/MyParseSet.json"));
    eval(fetch(configDp.cj));
    log(vipUrl+'æ­£åœ¨æ–­æ’é­”æ”¹ç‰ˆè§£æ...');
    return aytmParse(vipUrl)
}

var çº¯é€šå… = (function (){
    function çº¯é€šå…(playUrl,_reChange){
        if(typeof(_reChange)!=='function'){
            // _reChange = function (u){return u};
            _reChange = false;
        }
        try {
            let {lazyParse} = $.require('hiker://page/globalParse?rule=é“é•¿ä»“åº“Pro');
            return lazyParse(playUrl,null,null,_reChange);
        }catch (e) {
            return 'toast://'+e.message
        }
    }
    return çº¯é€šå…
})();

var çº¯X5 = (function (){
    function çº¯X5(playUrl,_x5){
        playUrl = playUrl||input;
        require(getVar('drä¾èµ–'));
        let useWeb=lsg.getItem("é€šå…","X5")==="WEB";
        let ruleHead=useWeb&&parseInt(getAppVersion())>=2339?"webRule://":"x5Rule://";
        showLoading('dræ¨¡æ¿'+lsg.getItem("é€šå…","X5")+'å—…æ¢ä¸­ï¼Œè¯·ç¨ç­‰...');
        log('å¼€å§‹'+lsg.getItem("é€šå…","X5")+'å—…æ¢:'+playUrl);
        playUrl = ruleHead+playUrl+ '@' +_x5;
        return playUrl
    }
    return çº¯X5
})();

var è§£æ={ // æä¾›äºŒçº§å‚æ•°ç»™é‚£ä¸ªå…å—…æ¢ç”¨
    æ˜¯å¦æ”¯æŒé­”æ–­:æ˜¯å¦æ”¯æŒé­”æ–­,
    æ˜¯å¦æ­£ç‰ˆ:æ˜¯å¦æ­£ç‰ˆ,
    æ˜¯å¦è§†é¢‘:æ˜¯å¦è§†é¢‘,
    çº¯é­”æ–­:çº¯é­”æ–­,
    çº¯é€šå…:çº¯é€šå…,
    çº¯X5:çº¯X5,
    åŠ è½½é­”æ–­:åŠ è½½é­”æ–­
};

function é­”æ–­(è·å–é“¾æ¥å‡½æ•°){
    è·å–é“¾æ¥å‡½æ•° = è·å–é“¾æ¥å‡½æ•°||function (input){
        return input
    };
    let lazy=$('').lazyRule((è·å–é“¾æ¥å‡½æ•°)=>{
        try{
            let realUrl = è·å–é“¾æ¥å‡½æ•°(input);
            eval("var configDp =" + fetch("hiker://files/cache/MyParseSet.json"));
            eval(fetch(configDp.cj));
            log(input+'->'+realUrl+'æ­£åœ¨æ–­æ’é­”æ”¹ç‰ˆè§£æ...');
            // åŠ å…¥è¶…æ—¶è®¾ç½®ï¼Œå»ºè®®åœ¨é¦–é¡µè®¾ç½®
            return aytmParse(realUrl)
        }catch(e){
            //return input
            const {lazyParse} = $.require('hiker://page/globalParse?rule=é“é•¿ä»“åº“Pro');
            return lazyParse(input);
        }
    },è·å–é“¾æ¥å‡½æ•°);
    return lazy
}

function é€šå…(_reChange){
    // å—…æ¢é“¾æ¥å†å¤„ç†å‡½æ•°
    // _reChange = _reChange||function (url){return url}; // å¿…ä¼ ,false
    _reChange = _reChange||false; // å¿…ä¼ ,false
    let lazy=$("").lazyRule((_reChange)=>{
        const {lazyParse} = $.require('hiker://page/globalParse?rule=é“é•¿ä»“åº“Pro');
        return lazyParse(input,null,null,_reChange);
    },_reChange);
    return lazy
}

function X5(_x5){
    let useWeb=lsg.getItem("é€šå…","X5")==="WEB";
    //log("ä»“åº“ä½¿ç”¨webé€šå…æ›¿ä»£x5:"+useWeb);
    let ruleHead=useWeb&&parseInt(getAppVersion())>=2339?"webRule://":"x5Rule://";
    return $('').lazyRule((ruleHead,_x5)=>{
        showLoading('dræ¨¡æ¿ç½‘é¡µå—…æ¢ä¸­ï¼Œè¯·ç¨ç­‰...');
        let playUrl = ruleHead+input+ '@' +_x5;
        // log(playUrl);
        return playUrl
    },ruleHead,_x5)
}

// ç¤ºä¾‹
/*
$.toString(() => {
    var urls = _getUrls();
    for (let i in urls) {
        if (urls[i].match(/\.mp3|\.mp4|\.m3u8|\.m4a/i)) {
            return urls[i] + '&memoryPosition=full#isMusic=true#'
        }
    }
    try {
        document.querySelector(".btn--play").click()
    } catch (e) {}

})
*/

var é€šç”¨ä¸€çº§å¤„ç† = {
    æ ‡é¢˜:function (input){
        return input
    },
    å›¾ç‰‡:function (input,html){
        //å‚æ•°äºŒæ˜¯å›¾ç‰‡é™„åŠ 
        // if (isPic(input) && !/@Referer=/.test(input)) {
        if (input && input.length>8 &&!/@Referer=/.test(input)) {
            input += '@Referer='
        }
        return input
    },
    æè¿°:function (input){
        return input
    },
    é“¾æ¥:function (input){
        // return input+'#immersiveTheme#'
        return input
    },
    å†…å®¹:function (input){
        return input
    },
    æ²‰æµ¸:true
};


var é€šç”¨äºŒçº§å¤„ç† = {
    é€‰é›†åç§°:function (input){
        return input
    },
    é€‰é›†é“¾æ¥:function (input){
        return input
    },
    å›¾ç‰‡:function (input){
        if (input && input.length>8 &&!/@Referer=/.test(input)) {
            input += '@Referer='
        }
        return input
    },
    å›¾ç‰‡ç‚¹å‡»:function(input){
        return input
    },
    é‡å®šå‘:function (input,html){ // å°†é€‰é›†å’Œçº¿è·¯é‡å®šå‘,å‚æ•°ä¸ºç½‘é¡µé“¾æ¥ï¼Œæºç ã€‚
        // inputè¿›è¡Œå¤„ç†è·å–æºç ä¹‹ç±»çš„
        return html
    }
};

function addTb(html){//è§£å†³jsoupåæ ‡ç­¾é—®é¢˜
    return (/<td>/.test(html)&&/<\/td>/.test(html)&&!/<table>/.test(html))?('<table>'+html+'</table>'):html;
}

function comParse(parStr,ej,onlyback,html,lazy,ä¸€çº§å¤„ç†){
    //åˆ—è¡¨ï¼Œæ ‡é¢˜ï¼Œå›¾ç‰‡ï¼Œæè¿°ï¼Œé“¾æ¥ï¼Œå†…å®¹
    ej = ej||false;//æœ‰äºŒçº§
    onlyback=onlyback||false;//åªè¿”å›æ•°æ®
    html = html||getResCode();
    html = typeof(html)==='string'?html:html.html;
    let t = parStr.split(";");
    let d = [];
    // lazy = lazy || $('').lazyRule(() => {
    //     const {lazyParse} = $.require('hiker://page/globalParse?rule=é“é•¿ä»“åº“Pro');
    //     return lazyParse(input)
    // });
    def_lazy = é€šå…();
    ä¸€çº§å¤„ç† = ä¸€çº§å¤„ç†||é€šç”¨ä¸€çº§å¤„ç†;
    function hasItem(html,location){//åˆ¤æ–­æºç æœ‰è¯¥å®šä½
        let o = location.split('&&'); // æŒ‰ && åˆ†å‰²
        for(let j of o){
            j = j.replace(/[.#]/g,'').replace(/\|\|/g,'|');
            let reg = new RegExp(j);
            // console.log(reg,reg.test(html));
            if(!reg.test(html)){
                return false
            }
        }
        return true
    }
    // log(ä¸€çº§å¤„ç†.è‡ªåŠ¨åŒ¹é…);
    if(ä¸€çº§å¤„ç†.è‡ªåŠ¨åŒ¹é…){
        var list = pdfa(html, t[0]);
        if((list.length<1&&!hasItem(html,t[0]))||(list.length<1&&MY_PAGE===1&&hasItem(html,t[0]))){//ç¬¬ä¸€é¡µéƒ½æ²¡æœ‰ç»“æœ
            // if(t[0].includes('module')){
            //     log(html);
            // }
            throw new Error("æœªåŒ¹é…åˆ°ä¸€çº§åˆ—è¡¨:"+t[0]);
        }
    }else{
        var list = [];
        try {
            list = pdfa(html, t[0]);
        }catch (e) {
            throw new Error("æœªåŒ¹é…åˆ°ä¸€çº§åˆ—è¡¨:"+t[0]);
        }
    }

    ä¸€çº§å¤„ç†.æ ‡é¢˜=ä¸€çº§å¤„ç†.æ ‡é¢˜||é€šç”¨ä¸€çº§å¤„ç†.æ ‡é¢˜;
    ä¸€çº§å¤„ç†.å›¾ç‰‡=ä¸€çº§å¤„ç†.å›¾ç‰‡||é€šç”¨ä¸€çº§å¤„ç†.å›¾ç‰‡;
    ä¸€çº§å¤„ç†.æè¿°=ä¸€çº§å¤„ç†.æè¿°||é€šç”¨ä¸€çº§å¤„ç†.æè¿°;
    ä¸€çº§å¤„ç†.é“¾æ¥=ä¸€çº§å¤„ç†.é“¾æ¥||é€šç”¨ä¸€çº§å¤„ç†.é“¾æ¥;
    ä¸€çº§å¤„ç†.å†…å®¹=ä¸€çº§å¤„ç†.å†…å®¹||é€šç”¨ä¸€çº§å¤„ç†.å†…å®¹;
    ä¸€çº§å¤„ç†.å›¾ç‰‡é™„åŠ =ä¸€çº§å¤„ç†.å›¾ç‰‡é™„åŠ ||html;
    ä¸€çº§å¤„ç†.æ²‰æµ¸=typeof(ä¸€çº§å¤„ç†.æ²‰æµ¸)==='boolean'?ä¸€çº§å¤„ç†.æ²‰æµ¸:é€šç”¨ä¸€çº§å¤„ç†.æ²‰æµ¸;
    for (let i in list) {
        let obj = {};
        let it = list[i];
        let æ ‡é¢˜ = t[1].split('.js:')[0];
        let å›¾ç‰‡ = t[2].split('.js:')[0];
        let æè¿° = t[3].split('.js:')[0];
        let é“¾æ¥ = t[4].split('.js:')[0];
        let _title = æ ‡é¢˜ ? pdfh(addTb(it), æ ‡é¢˜) : '';
        let _pic_url = å›¾ç‰‡ ? pd(addTb(it), å›¾ç‰‡) : '';
        let _desc = æè¿° ? pdfh(addTb(it), æè¿°) : '';
        let _é“¾æ¥ = é“¾æ¥ ? pd(addTb(it), é“¾æ¥) : '';
        if (t.length > 5) {//å†…å®¹ï¼Œç”¨äºæœç´¢
            let å†…å®¹ = t[5].split('.js:')[0];
            let _content = å†…å®¹ ? pdfh(addTb(it), å†…å®¹) : '';
            obj.content = ä¸€çº§å¤„ç†.å†…å®¹(_content)
        }
        let _url = ä¸€çº§å¤„ç†.é“¾æ¥(_é“¾æ¥);
        if(!/#immersiveTheme#/.test(_url)&&ä¸€çº§å¤„ç†.æ²‰æµ¸&&!/@lazyRule=/.test(_url)){//åŠ ä¸Šæ²‰æµ¸
            _url+='#immersiveTheme#'
        }
        // _url = ej ? _url : (_url + lazy);
        _url = ej ? _url : (_url + getLazy(_url,lazy));
        if (_url.startsWith('http') && ej) {//ç½‘ç»œé“¾æ¥ä¸”æœ‰äºŒçº§çš„æƒ…å†µä¸‹è‡ªåŠ¨åŠ hiker
            _url = 'hiker://empty##' + _url
        }
        let title = ä¸€çº§å¤„ç†.æ ‡é¢˜(_title);
        let pic_url = ä¸€çº§å¤„ç†.å›¾ç‰‡(_pic_url,ä¸€çº§å¤„ç†.å›¾ç‰‡é™„åŠ );
        let desc = ä¸€çº§å¤„ç†.æè¿°(_desc);
        obj.title = title;
        obj.pic_url = pic_url;
        obj.desc = desc;
        // obj.url = _url;
        obj.url = getMyVar('test_mode') ? $(_url).rule(() => {
            let rule =  MY_RULE.title;//è·å–è§„åˆ™å
            let jsCode = JSON.parse(request('hiker://home@' + rule)).detail_find_rule.replace('js:','');
            eval(jsCode);
            // require(config.è‡ªåŠ¨åŒ¹é…);
            // è‡ªåŠ¨äºŒçº§();
        }) : _url;
        obj.extra = {
            title:title||'',
            name:MY_RULE.title,
            pic_url:pic_url||'',
            desc:desc||'',
            content:obj.content||'',
            url:_url||'hiker://empty',
        };
        if (!ej) {
            Object.assign(obj.extra,{
                id: _é“¾æ¥,
                jsLoadingInject: true,
                blockRules: ['baidu.*.png','.mp3', '.mp4', '.flv', '.avi', '.3gp', '.mpeg', '.wmv', '.mov', '.rmvb', '.gif', '.png', '.ico', '.svg']
            });
        }
        if(ä¸€çº§å¤„ç†.é™„åŠ &&typeof(ä¸€çº§å¤„ç†.é™„åŠ )==='function'){
            let other_extra = ä¸€çº§å¤„ç†.é™„åŠ (obj.extra)||{};
            Object.assign(obj.extra,other_extra);
        }
        if(ä¸€çº§å¤„ç†.å¯¹è±¡&&typeof(ä¸€çº§å¤„ç†.å¯¹è±¡)==='function'){
            let modyObj = ä¸€çº§å¤„ç†.å¯¹è±¡(obj)||{};
            Object.assign(obj,modyObj);
        }
        d.push(obj);
    }
    if(onlyback){
        return d
    }else{
        setResult(d)
    }
}

//æ–‡ä»¶æ‰©å±•å
function getFileUploadExtension(obj) {
    if (obj !== null) {
        var value = obj.value.trim();
        if (value.length > 0) {
            var index = value.lastIndexOf(".") + 1;
            var ext = value.substring(index).toLowerCase();
            return ext;
        }
    }
    return "";
}

//for(let key in lsg){log(key)}
function å›¾ç‰‡(picStr){
    picStr = picStr||{};
    let ç¼–ç  = picStr.ç¼–ç ||'utf-8';//å¯é€‰æ‹©gb18030
    let æœ€å¤§é¡µæ•° = picStr.æœ€å¤§é¡µæ•°||function (){return 1};
    let åˆ—è¡¨ = picStr.åˆ—è¡¨||'.content&&img';
    let å›¾ç‰‡ = picStr.å›¾ç‰‡||'img&&src';
    let æ¥æº = '@Referer='+(picStr.æ¥æº||'');
    let é“¾æ¥æ›¿æ¢ = picStr.é“¾æ¥æ›¿æ¢||function (input,p){return input.replace(".html", "_" + p + ".html")};
    let obj = {
        ç¼–ç :ç¼–ç ,
        æœ€å¤§é¡µæ•°:æœ€å¤§é¡µæ•°,
        åˆ—è¡¨:åˆ—è¡¨,
        å›¾ç‰‡:å›¾ç‰‡,
        æ¥æº:æ¥æº,
        é“¾æ¥æ›¿æ¢:é“¾æ¥æ›¿æ¢
    };
    /*
    let lazy=$('').lazyRule((obj)=>{
        let html = request(input, {
            headers: {
                "content-type": "charset="+obj.ç¼–ç 
            }
        });
        // let max = pdfh(html, ".page&&Text").match(/å…±(.*?)é¡µ/)[1];
        let max = obj.æœ€å¤§é¡µæ•°(html); // function(html){return pdfh(html, ".page&&Text").match(/å…±(.*?)é¡µ/)[1]}
        // log("å…±æœ‰:"+max+"é¡µ");
        let map = (html, arr) => {
            var realObj = [];
            if(typeof(obj.åˆ—è¡¨)==='string'){
                realObj = pdfa(html, obj.åˆ—è¡¨)
            }else if(typeof(obj.åˆ—è¡¨)==='function'){
                realObj = obj.åˆ—è¡¨(html)
            }
            realObj.map(it => {
                arr.push(pd(it, obj.å›¾ç‰‡)+obj.æ¥æº);
            });
        };
        var htmlUrl = [];
        for (let p = 2; p <= max; p++) {
            htmlUrl.push({
                // url: input.replace(".html", "_" + p + ".html"),
                url: obj.é“¾æ¥æ›¿æ¢(input,p),
                options: {
                    headers: {
                        "content-type": "charset="+obj.ç¼–ç 
                    }
                }
            });
        }
        var htmlArr = htmlUrl.length>0?batchFetch(htmlUrl):[];
        let pics=[];
        htmlArr.unshift(html);
        htmlArr.map(it=>map(it,pics));
        return 'pics://' + pics.join('&&');
    },obj);
    */
    let lazy = `var obj=${$.stringify(obj)};var lazy=`+function (input){
        let html = request(input, {
            headers: {
                "content-type": "charset="+obj.ç¼–ç 
            }
        });
        // let max = pdfh(html, ".page&&Text").match(/å…±(.*?)é¡µ/)[1];
        let max = obj.æœ€å¤§é¡µæ•°(html); // function(html){return pdfh(html, ".page&&Text").match(/å…±(.*?)é¡µ/)[1]}
        // log("å…±æœ‰:"+max+"é¡µ");
        let map = (html, arr) => {
            var realObj = [];
            if(typeof(obj.åˆ—è¡¨)==='string'){
                realObj = pdfa(html, obj.åˆ—è¡¨)
            }else if(typeof(obj.åˆ—è¡¨)==='function'){
                realObj = obj.åˆ—è¡¨(html)
            }
            realObj.map(it => {
                arr.push(pd(it, obj.å›¾ç‰‡)+obj.æ¥æº);
            });
        };
        var htmlUrl = [];
        for (let p = 2; p <= max; p++) {
            htmlUrl.push({
                // url: input.replace(".html", "_" + p + ".html"),
                url: obj.é“¾æ¥æ›¿æ¢(input,p),
                options: {
                    headers: {
                        "content-type": "charset="+obj.ç¼–ç 
                    }
                }
            });
        }
        var htmlArr = htmlUrl.length>0?batchFetch(htmlUrl):[];
        let pics=[];
        htmlArr.unshift(html);
        htmlArr.map(it=>map(it,pics));
        return 'pics://' + pics.join('&&');
    }.toString();
    let path = 'hiker://files/cache/js/drå›¾ç‰‡å…å—….js';
    writeFile(path,lazy);
    lazy = $("").lazyRule((path)=>{
        // return input+request(path);
        eval(request(path));
        return lazy(input);
    },path);
    return lazy
}

function ä¸‹è½½å›¾ç‰‡(playUrl,å®šä½){
    MY_URL = playUrl;
    å®šä½ = å®šä½||{};
    let ç¼–ç  = å®šä½.ç¼–ç ||'utf-8';//å¯é€‰æ‹©gb18030
    let æœ€å¤§é¡µæ•° = å®šä½.æœ€å¤§é¡µæ•°||function (){return 1};
    let åˆ—è¡¨ = å®šä½.åˆ—è¡¨||'.content&&img';
    let å›¾ç‰‡ = å®šä½.å›¾ç‰‡||'img&&src';
    let æ¥æº = '@Referer='+(å®šä½.æ¥æº||'');
    let é“¾æ¥æ›¿æ¢ = å®šä½.é“¾æ¥æ›¿æ¢||function (input,p){return input.replace(".html", "_" + p + ".html")};
    let obj = {
        ç¼–ç :ç¼–ç ,
        æœ€å¤§é¡µæ•°:æœ€å¤§é¡µæ•°,
        åˆ—è¡¨:åˆ—è¡¨,
        å›¾ç‰‡:å›¾ç‰‡,
        æ¥æº:æ¥æº,
        é“¾æ¥æ›¿æ¢:é“¾æ¥æ›¿æ¢
    };
    let html = request(playUrl, {
        headers: {
            "content-type": "charset="+obj.ç¼–ç 
        }
    });
    // let max = pdfh(html, ".page&&Text").match(/å…±(.*?)é¡µ/)[1];
    let max = obj.æœ€å¤§é¡µæ•°(html); // function(html){return pdfh(html, ".page&&Text").match(/å…±(.*?)é¡µ/)[1]}
    // log("å…±æœ‰:"+max+"é¡µ");
    let map = (html, arr) => {
        var realObj = [];
        if(typeof(obj.åˆ—è¡¨)==='string'){
            realObj = pdfa(html, obj.åˆ—è¡¨)
        }else if(typeof(obj.åˆ—è¡¨)==='function'){
            realObj = obj.åˆ—è¡¨(html)
        }
        realObj.map(it => {
            arr.push(pd(it, obj.å›¾ç‰‡)+obj.æ¥æº);
            // arr.push([pd(it, obj.å›¾ç‰‡),{referer:obj.æ¥æº.split('@Referer=')[1]}]);
        });
    };
    var htmlUrl = [];
    for (let p = 2; p <= max; p++) {
        htmlUrl.push({
            // url: input.replace(".html", "_" + p + ".html"),
            url: obj.é“¾æ¥æ›¿æ¢(playUrl,p),
            options: {
                headers: {
                    "content-type": "charset="+obj.ç¼–ç 
                }
            }
        });
    }
    var htmlArr = htmlUrl.length>0?batchFetch(htmlUrl):[];
    let pics=[];
    htmlArr.unshift(html);
    htmlArr.map(it=>map(it,pics));
    // log(pics);
    return pics;
}

function å°è¯´(å®šä½,æŒ‡å®šç¼–ç ){
    å®šä½ = å®šä½||{
        æ ‡é¢˜:function (input){return input},
        å†…å®¹:function (input){return input},
        // é“¾æ¥:function (input){return input},
    };
    ç¼–ç =(typeof(ç¼–ç )==='undefined'||!ç¼–ç )?false:ç¼–ç ;
    ç¼–ç  = æŒ‡å®šç¼–ç ||ç¼–ç ||'utf-8';
    é˜…è¯»æ¨¡å¼ = true;//ç”³æ˜å…¨å±€é˜…è¯»æ¨¡å¼å¯ç”¨
    let lazy = `var å®šä½=${$.stringify(å®šä½)};var ç¼–ç =${$.stringify(ç¼–ç )};var lazy=`+function (input){
        require(config['æ¨¡æ¿']);
        input = MY_URL;
        // log('å½“å‰å°è¯´é“¾æ¥:'+input);
        // log('ruleé‡Œçš„input:'+input);
        // let urls = [input]; // é“¾æ¥åˆ—è¡¨
        var urls = []; // é“¾æ¥åˆ—è¡¨
        let html = è·å–æºç (input,'','','',{
            "content-type": "charset="+ç¼–ç 
        });
        // log(html);
        if(typeof(å®šä½.é“¾æ¥)==='function'){
            // log('æ‰§è¡Œå®šä½é“¾æ¥');
            try {
                urls = å®šä½.é“¾æ¥(html)||[];
            }
            catch (e) {}
        }else{
            // log('å®šä½é“¾æ¥ä¸æ˜¯ä¸ªå‡½æ•°')
        }
        let d = [];
        let htmlUrl=[];
        if(urls.length>0&&urls.filter(it => it !== input).length>0) {
            for (let i in urls.filter(it => it !== input)) {
                htmlUrl.push({
                    url: urls[i],
                    options: {
                        headers: {
                            "content-type": "charset=utf-8"
                        }
                    }
                });
            }
            //æ‰¹é‡è¯·æ±‚æºç å¼€å¤´åŠ ä¸Šè‡ªèº«html
            let htmls=batchFetch(htmlUrl);
            htmls.unshift(html);
            html = htmls;
        }else {
            html = [html];
        }

        function å°è¯´å‡€åŒ–(content){
            let path = 'hiker://files/rules/dzHouse/json/å°è¯´å‡€åŒ–.json';
            if(!fileExist(path)){
                requireDownload('https://dr.playdreamer.cn/libs/å°è¯´å‡€åŒ–.json', path);
            }
            content = pdfh(content,'body&&Text');
            let javaString = java.lang.String(content);
            let ruleList = JSON.parse(request(path) || "[]");
            let replacePattern = ["replace", "replaceAll"];
            for (let i = 0, len = ruleList.length; i < len; i++) {
                let replaceRule = ruleList[i];
                let replace = replacePattern[0 + replaceRule.isRegex];
                try {
                    javaString = javaString[replace](replaceRule.pattern, replaceRule.replacement);
                }catch (e) {log(replaceRule.name+'å‡€åŒ–å¤±è´¥:'+e.message)}
            }
            content = String(javaString);
            content = "ã€€ã€€" + content.replace(/^\s+|\s+$/gm, "").split(/\n+/).join("<br>ã€€ã€€");
            return content
        }

        // log('æœ¬ç« èŠ‚å…±è®¡å¤šå°‘é¡µ:'+html.length);
        for (let j in html) {
            let it = html[j];
            d.push({
                col_type: "rich_text",
                // title: "â€œâ€œâ€â€<big>" + parseDomForHtml(getResCode(), "h1&&Text") + "</big>",
                title: å®šä½.æ ‡é¢˜(it),
            });
            d.push({
                // title: parseDomForHtml(getResCode(), "#acontent&&Html"),
                title: å°è¯´å‡€åŒ–(å®šä½.å†…å®¹(it)),
                col_type: 'rich_text',
                extra: {
                    textSize: 16,
                    click: true
                }
            });
        }
        setResult(d);

    }.toString();
    /*
    return $('').rule((å®šä½,ç¼–ç )=>{
        require(config['æ¨¡æ¿']);
        input = MY_URL;
        // log('ruleé‡Œçš„input:'+input);
        // let urls = [input]; // é“¾æ¥åˆ—è¡¨
        var urls = []; // é“¾æ¥åˆ—è¡¨
        let html = è·å–æºç (input,'','','',{
            "content-type": "charset="+ç¼–ç 
        });
        if(typeof(å®šä½.é“¾æ¥)==='function'){
            // log('æ‰§è¡Œå®šä½é“¾æ¥');
            try {
                urls = å®šä½.é“¾æ¥(html)||[];
            }
            catch (e) {}
        }else{
            // log('å®šä½é“¾æ¥ä¸æ˜¯ä¸ªå‡½æ•°')
        }
        let d = [];
        let htmlUrl=[];
        if(urls.length>0&&urls.filter(it => it !== input).length>0) {
            for (let i in urls.filter(it => it !== input)) {
                htmlUrl.push({
                    url: urls[i],
                    options: {
                        headers: {
                            "content-type": "charset=utf-8"
                        }
                    }
                });
            }
            //æ‰¹é‡è¯·æ±‚æºç å¼€å¤´åŠ ä¸Šè‡ªèº«html
            let htmls=batchFetch(htmlUrl);
            htmls.unshift(html);
            html = htmls;
        }else {
            html = [html];
        }
        // log('æœ¬ç« èŠ‚å…±è®¡å¤šå°‘é¡µ:'+html.length);
        for (let j in html) {
            let it = html[j];
            d.push({
                col_type: "rich_text",
                // title: "â€œâ€œâ€â€<big>" + parseDomForHtml(getResCode(), "h1&&Text") + "</big>",
                title: å®šä½.æ ‡é¢˜(it),
            });
            d.push({
                // title: parseDomForHtml(getResCode(), "#acontent&&Html"),
                title: å®šä½.å†…å®¹(it),
                col_type: 'rich_text',
                extra: {
                    textSize: 16,
                    click: true
                }
            });
        }
        setResult(d);
    },å®šä½,ç¼–ç );
    */
    let path = 'hiker://files/cache/js/drå°è¯´å…å—….js';
    writeFile(path,lazy);
    lazy = $("").rule((path)=>{
        input = MY_URL;//ruleç›¸æ¯”lazyRuleæ²¡æœ‰inputï¼Œæ‰€ä»¥å¾—æŠŠMY_URLèµ‹å€¼ç»™input
        // return input+request(path);
        eval(request(path));
        return lazy(input);
    },path);
    return lazy
}

function ç« èŠ‚å†…å®¹(playUrl,å®šä½,æŒ‡å®šç¼–ç ){
    MY_URL = playUrl;//å…³é”®
    å®šä½ = å®šä½||{
        æ ‡é¢˜:function (input){return input},
        å†…å®¹:function (input){return input},
        // é“¾æ¥:function (input){return input},
    };
    ç¼–ç =(typeof(ç¼–ç )==='undefined'||!ç¼–ç )?false:ç¼–ç ;
    ç¼–ç  = æŒ‡å®šç¼–ç ||ç¼–ç ||'utf-8';
    var urls = []; // é“¾æ¥åˆ—è¡¨
    let html = è·å–æºç (playUrl,'','','',{
        "content-type": "charset="+ç¼–ç 
    });
    if(typeof(å®šä½.é“¾æ¥)==='function'){
        // log('æ‰§è¡Œå®šä½é“¾æ¥');
        try {
            urls = å®šä½.é“¾æ¥(html)||[];
        }
        catch (e) {}
    }else{
        //log('å®šä½é“¾æ¥ä¸æ˜¯ä¸ªå‡½æ•°ï¼Œæ˜¯:'+typeof(å®šä½.é“¾æ¥));
    }
    let htmlUrl=[];
    if(urls.length>0&&urls.filter(it => it !== playUrl).length>0) {
        for (let i in urls.filter(it => it !== playUrl)) {
            htmlUrl.push({
                url: urls[i],
                options: {
                    headers: {
                        "content-type": "charset="+ç¼–ç 
                    }
                }
            });
        }
        //æ‰¹é‡è¯·æ±‚æºç å¼€å¤´åŠ ä¸Šè‡ªèº«html
        let htmls=batchFetch(htmlUrl);
        htmls.unshift(html);
        html = htmls;
    }else {
        html = [html];
    }
    var content = '';
    for (let j in html) {
        let it = html[j];
        let tmp = å®šä½.å†…å®¹(it).replace(/<p>/g,'').replace(/<\/p>/g,'').replace(/<br>/g,'\n');
        tmp = tmp.split('\n').join('\nã€€ã€€');
        content+=tmp;
    }
    return content
}
//è°ƒç”¨ var lazy=å°è¯´();


function getCode(){//ç”¨äºä¸€çº§å‡½æ•°è·å–æºç 
    let curl=MY_TYPE==='search'?è·å–æœç´¢é“¾æ¥(MY_URL):MY_URL;
    return /<\/html>/.test(getResCode())?getResCode():è·å–æºç (curl)
}

function ä¸€çº§(parStr,ej,d,rule_id,yj_html,onlyback){
//åˆ—è¡¨ï¼Œæ ‡é¢˜ï¼Œå›¾ç‰‡ï¼Œæè¿°ï¼Œé“¾æ¥ï¼Œå†…å®¹
//æ˜¯å¦æœ‰äºŒçº§ï¼Œå¿…é¡»å¡«trueæ‰æœ‰
//å‰ç½®æ•°æ®dã€‚å¯ä¸å¡«,æˆ–è€…æ³¨å…¥åŠ¨æ€åˆ†ç±»ï¼Œæœç´¢æ¡†ä¹‹ç±»çš„
//å…è´£å£°æ˜localstorage ID ,ä¼ falseæˆ–è€…nullåˆ™æ— éœ€å…è´£å£°æ˜
//ç½‘é¡µæºç /æ–‡æœ¬æˆ–è€…jsonå¯¹è±¡ {html:'',page:''}
    addListener('onClose', $.toString(()=>{
        // initConfig({}); //æ¸…ç©ºé…ç½®,é¿å…ç‚¸è§†ç•Œ
        clearMyVar('header.url');
        clearMyVar('header.category');
    }));
    initConfig({html:''});//æ¸…ç©ºäºŒçº§è®°å½•
    d=d||[];
    onlyback = onlyback||false;
    // rule_id=rule_id||MY_RULE.title;
    rule_id=rule_id||false;
    password=(typeof(password)==='undefined'||!password)?'dz':password;
    let nv=parseInt(getAppVersion());
    var ruleName = MY_RULE.title;
    // log(ruleName+'=>'+nv);
    if(nv<version.appv){
        setResult([
            {
                title:"è¯·æ›´æ–°è§†ç•Œè‡³"+version.appv+"ä»¥ä¸Šï¼Œå½“å‰"+nv,
                col_type:'text_1',
                url:'hiker://empty'
            }
        ]);
        return;
    }else if(rule_id===true&&!lsg.getItem(ruleName,'')){
        let title = '<small>è¯´æ˜ æœ¬ç¨‹åºæ‰€æä¾›çš„æ‰€æœ‰æ•°æ®å‡æ¥è‡ªäºäº’è”ç½‘ï¼Œä¸ªäººå­˜æ”¾åœ¨æ­¤ä½œä¸ºå¤‡ç”¨ï¼Œä»¥å¤‡å°†æ¥ä¸æ—¶ä¹‹éœ€ï¼ŒåŒæ—¶ä½œä¸ºå¤§å®¶çš„åˆ†äº«å’Œå­¦ä¹ æˆæœï¼Œä»…ä¾›ä¸ªäººç ”ç©¶å’Œå­¦ä¹ ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œä¸‹è½½åè¯·äº24å°æ—¶å†…åˆ é™¤ï¼Œè¯·æ”¯æŒæ­£ç‰ˆï¼</small>';
        let desc = '';
        let agree = 'æˆ‘åŒæ„';
        d = [];//é‡ç½®åˆ†ç±»ç­‰
        d.push({
            title:title+'<br>'+desc,
            col_type:'rich_text',
        });
        let pobj = {
            version:version,
            ruleName:ruleName,
            password:password,
        };
        let idata = base64Encode(JSON.stringify(pobj));
        d.push({
            title:color(agree,'#ab2415'),
            col_type:'text_center_1',
            url:$('',base64Decode('6K+36L6T5YWl6YGT6ZW/5LiT55So5a+G56CB')).input((idata)=>{
                idata = JSON.parse(base64Decode(idata));
                var version=idata.version,ruleName=idata.ruleName,password=idata.password;
                evalPrivateJS('zSWve+eeA6iL+f2fGTI+1q/UDtPcs7FYj2zolrQ08HHrDJCJG86PqcEvlowy2y4oJwlVUOGKTvxUQXa1G9IzhY6g0rc8E8bqMw0ePRKZ8u8FCmJPoRCqODM1Q1jlRBlxIHCS0p05zvTSHe4Nt1LsbA==');
                eval(base64Decode('cHdkID0gcGFzc3dvcmQrcHdkOw=='));
                if(input===eval(base64Decode('cHdk'))) {
                    require(version.requireId);
                    lsg.setItem(ruleName, 'ok');
                    refreshPage(true);
                    return 'toast://ä½ å·²ç»æ¥å—æ­¤éœ¸ç‹æ¡æ¬¾,åç»­ç¨‹åºé—®é¢˜ä¸ä½œè€…æ— å…³'
                }else{
                    return 'toast://å¯†ç é”™è¯¯,æ‹’ç»è®¿é—®'
                }
            },idata),
            // },version,ruleName,evalPrivateJS('GRDlFiXQPYhGvmtchpNk6Q==')),
            extra: {
                lineVisible:false
            }
        });
        setResult(d);
        return;
    }
    else if(nv>=2331&&rule_id&&typeof(rule_id)==='string'&&!lsg.getItem(rule_id,'')){
        let title = '<small>è¯´æ˜ æœ¬ç¨‹åºæ‰€æä¾›çš„æ‰€æœ‰æ•°æ®å‡æ¥è‡ªäºäº’è”ç½‘ï¼Œä¸ªäººå­˜æ”¾åœ¨æ­¤ä½œä¸ºå¤‡ç”¨ï¼Œä»¥å¤‡å°†æ¥ä¸æ—¶ä¹‹éœ€ï¼ŒåŒæ—¶ä½œä¸ºå¤§å®¶çš„åˆ†äº«å’Œå­¦ä¹ æˆæœï¼Œä»…ä¾›ä¸ªäººç ”ç©¶å’Œå­¦ä¹ ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œä¸‹è½½åè¯·äº24å°æ—¶å†…åˆ é™¤ï¼Œè¯·æ”¯æŒæ­£ç‰ˆï¼</small>';
        let desc = '<small>é™„: äºŒâ—‹â—‹äºŒå¹´ä¸€æœˆä¸€æ—¥ã€Šè®¡ç®—æœºè½¯ä»¶ä¿æŠ¤æ¡ä¾‹ã€‹ç¬¬åä¸ƒæ¡è§„å®šï¼šä¸ºäº†å­¦ä¹ å’Œç ”ç©¶è½¯ä»¶å†…å«çš„è®¾è®¡æ€æƒ³å’ŒåŸç†ï¼Œé€šè¿‡å®‰è£…ã€æ˜¾ç¤ºã€ä¼ è¾“æˆ–è€…å­˜å‚¨è½¯ä»¶ç­‰æ–¹å¼ä½¿ç”¨è½¯ä»¶çš„ï¼Œå¯ä»¥ä¸ç»è½¯ä»¶è‘—ä½œæƒäººè®¸å¯ï¼Œä¸å‘å…¶æ”¯ä»˜æŠ¥é…¬!</small>';
        desc = '';
        let agree = 'æˆ‘æ„¿æ„æ‰¿æ‹…è´£ä»»,å¹¶å¼€å§‹å­¦ä¹ ç ”ç©¶';
        agree = 'æˆ‘åŒæ„';
        d = [];//é‡ç½®åˆ†ç±»ç­‰
        // let btn = '<a href="">æˆ‘ä¸æ„¿æ‰¿æ‹…è´£ä»»,ç«‹å³åˆ é™¤æ­¤ç¨‹åº</a><br><a href>æˆ‘æ„¿æ„æ‰¿æ‹…è´£ä»»,å¼€å§‹å­¦ä¹ ç ”ç©¶</a>'
        d.push({
            title:title+'<br>'+desc,
            // desc:desc,
            col_type:'rich_text',
        });
        d.push({
            title:color(agree,'#ab2415'),
            col_type:'text_center_1',
            url:$('#noLoading#').lazyRule((version,rule_id)=>{
                require(version.requireId);
                lsg.setItem(rule_id,'ok');
                // putMyVar('show','ok');
                refreshPage(true);
                return 'toast://ä½ å·²ç»æ¥å—æ­¤éœ¸ç‹æ¡æ¬¾,åç»­ç¨‹åºé—®é¢˜ä¸ä½œè€…æ— å…³'
            },version,rule_id),
            extra: {
                lineVisible:false
            }
        });
        setResult(d);
        return;
    }
    lazy=(typeof(lazy)==='undefined'||!lazy)?false:lazy;
    html=((typeof(html)==='undefined'||!html)&&!yj_html)?getCode():(yj_html||html);
    ä¸€çº§å¤„ç†=(typeof(ä¸€çº§å¤„ç†)==='undefined'||!ä¸€çº§å¤„ç†)?false:ä¸€çº§å¤„ç†;
    let jscode=comParse(parStr,ej,true,html,lazy,ä¸€çº§å¤„ç†);
    d=d.concat(jscode);
    if(onlyback){
        return d;
    }else{
        setResult(d);
        return d;
    }
}

function ä¸€çº§ä¹¦ç­¾(detailUrl,setUrl,extra,d){//è´è´ä¹¦ç­¾ æ‹¦æˆªè¯¦æƒ…é¡µï¼Œè®¾ç½®é¡µ,è¿‡æ»¤ï¼Œé™„åŠ åŠŸèƒ½
    detailUrl = detailUrl||'/detail/'; //è¯¦æƒ…é¡µé“¾æ¥å¦‚ 'vod/detail/'
    extra = extra||{};
    d = d&&Array.isArray(d)?d:[];//é™„åŠ è®¾ç½®
    setUrl = setUrl||false;//è®¾ç½®é¡µ
    MY_URL = MY_URL.replace('hiker://empty##',''); // æ‹¿åˆ°åœ°å€æ é“¾æ¥
    let js = $.toString((MY_RULE,detailUrl,setUrl,d) => {
        MY_URL=input;//é™„åŠ é¦–é¡µåœ°å€ä¸ºäº†getHomeæ­£å¸¸è¿è¡Œ
        var rule = MY_RULE.title;//å°ç¨‹åºåç§°
        var host=getHome(input);//è·å–æ‹¦æˆªåœ°å€çš„åŸŸå
        var route=input.replace(host,'');//è·å–æ‹¦æˆªåœ°å€çš„è·¯ç”±
        // if((!setUrl&&(route==='/'||route===''))||route===setUrl){//é™„åŠ è®¾ç½®åŠŸèƒ½æ‹¦æˆªé¦–é¡µ
        var detail_reg = detailUrl.split('|').map(it=>it.startsWith(".")?'\\'+it:it).join("|");
        var setUrl_reg = setUrl?setUrl.split('|').map(it=>it.replace(/[.]/g,'\\.')).join("|"):'/';
        // route.includes(setUrl)
        if((!setUrl&&(route==='/'||route===''))||route===setUrl||(setUrl.length>2&&(new RegExp(setUrl_reg)).test(route))){//é™„åŠ è®¾ç½®åŠŸèƒ½æ‹¦æˆªé¦–é¡µ
            return $.toString((url,MY_RULE, rule,d) => {
                let ejUrl = 'hiker://empty##' + url;
                let group = MY_RULE.group;
                let preRule = MY_RULE.preRule2||MY_RULE.preRule;
                let pages = MY_RULE.pages;
                fba.open(JSON.stringify({
                    title:'éšè—åŠŸèƒ½',
                    rule: rule,
                    url: ejUrl,
                    group:group,
                    preRule:preRule,
                    pages:pages,
                    findRule: "js:" + $$$.toString((preRule,rule,d) => {//è‡ªå®šä¹‰jsé¡µé¢è§„åˆ™ä»£ç å†™æ³•
                        if(!config.æ¨¡æ¿){//æ‰§è¡Œé¢„å¤„ç†å®Œäº†hook configï¼Œæˆ–è€…ç”¨refreshä¹Ÿè¡Œ
                            eval(preRule);
                            // log('æ‰§è¡Œäº†é¢„å¤„ç†:'+preRule);
                            let _cfg = getMyVar('initConfig', '{}');
                            if (_cfg && _cfg.length > 0) {
                                config = JSON.parse(_cfg);
                            }
                        }
                        addListener('onClose', $.toString(() => {
                            refreshPage();//ç›‘å¬è¿”å›å°±åˆ·æ–°é¡µé¢.yyds
                        }));
                        require(config['æ¨¡æ¿']);
                        var s = [];
                        // var page=1;//è®¾ç½®é¡µé¢å›ºå®šå½“å‰é¡µæ•°ä¸º1,ä¸èµ·ä½œç”¨çš„
                        // log('page:'+page);
                        // log('mpg:'+MY_PAGE);
                        è®¾ç½®(s);
                        d.unshift(s[0]);
                        d = d.concat(åŒ¹é…è®¾ç½®('text_2'));
                        /*
                        d.push({
                            title: 'ğŸ”™è¿”å›å¹¶åˆ·æ–°ç”Ÿæ•ˆ',
                            desc:'ä¸ºèŠ‚çœæ€§èƒ½ï¼Œç›´æ¥ç‚¹å·¦ä¸Šè§’è¿”å›ä¸ä¼šåˆ·æ–°å’Œç”Ÿæ•ˆ',
                            col_type: 'text_1',
                            url: $('#noLoading#').lazyRule(() => {
                                clearMyVar('æ˜¯å¦è¿›å…¥è§„åˆ™');
                                back(true)
                                // refreshX5WebView('http://127.0.0.1:4848');
                                // refreshX5Desc('float&&0');
                                return 'hiker://empty'
                            })
                        });
                        */
                        setResult(d);
                    }, preRule,rule,d),
                }));
            }, input, MY_RULE,rule,d)

        }else if ((new RegExp(detail_reg)).test(input)) {
            // åŸæ¥å†™æ³•,ä¸æ”¯æŒæ­£åˆ™ input.includes(detailUrl)
            return $.toString((url, MY_RULE,rule) => {
                let ejUrl = 'hiker://empty##' + url + '#immersiveTheme#';
                fba.parseLazyRule($$$().lazyRule((ck,rule)=>{
                    let privateCk = rule+'@cookie';
                    putVar(privateCk,ck);
                    // log('å·²è®¾ç½®cookie:'+ck);
                    // log('è®¾ç½®åcookie:'+getVar(privateCk));
                    return 'hiker://empty';
                },document.cookie,rule));
                let group = MY_RULE.group;
                let preRule = MY_RULE.preRule2||MY_RULE.preRule;
                let pages = MY_RULE.pages;
                let detail_find_rule = MY_RULE.detail_find_rule||JSON.parse(request('hiker://home@' + rule)).detail_find_rule;
                fba.open(JSON.stringify({
                    // title: rule,
                    title:'è¯¦æƒ…é¡µ',
                    rule: rule,
                    group:group,
                    preRule:preRule,
                    pages:pages,
                    // url: 'hiker://page/ej?rule=' + rule + '&url=' + url,//å­é¡µé¢å†™æ³•
                    url: ejUrl,
                    // findRule:JSON.parse(request('hiker://home@' + rule)).detail_find_rule,
                    findRule: "js:" + $$$.toString((preRule,detail_find_rule) => {//è‡ªå®šä¹‰jsé¡µé¢è§„åˆ™ä»£ç å†™æ³•
                        if(!config.æ¨¡æ¿){
                            eval(preRule);
                            // log('æ‰§è¡Œäº†é¢„å¤„ç†:'+preRule);
                            let _cfg = getMyVar('initConfig', '{}');
                            if (_cfg && _cfg.length > 0) {
                                config = JSON.parse(_cfg);
                            }
                        }
                        // log(config);
                        // å¯èƒ½æµ‹è¯•ç¯å¢ƒå–ä¸åˆ° MY_RULE.detail_find_ruleå°±evalæœ¬è§„åˆ™
                        eval(detail_find_rule);
                    }, preRule,detail_find_rule),
                }));
            }, input,MY_RULE, rule)
        }
    }, MY_RULE,detailUrl,setUrl,d);
    extra = Object.assign({
        canBack: true,
        urlInterceptor: js,
        floatVideo: true,
    },extra);
    setResult([{
        col_type: "x5_webview_single",
        url: MY_URL,
        desc: "float&&100%",
        extra: extra
    }]);
}

function getLazy(url,lazy) {//åŠ¨æ€è·å–åŠ¨æ€è§£æå¯å…¼å®¹ç£åŠ›é“¾æ¥
    if ((typeof(lazy)==='undefined'||!lazy) && /^magnet:\?|^ftp:|^thunder:/.test(url.trim())) {//å¤„ç†ç£åŠ›
        return ''
    } else {
        def_lazy = (typeof(def_lazy)==='undefined'||!def_lazy)?'':def_lazy;
        return lazy || def_lazy
    }
}

function é™„åŠ æ•°æ®(more_data,more_tips){//ä¼ å…¥é™„åŠ çš„æ•°æ®å‚æ•°
    if(!Array.isArray(more_data)||more_data.length<1){//ä¼ å…¥é™„åŠ æ•°æ®å¿…é¡»æ˜¯å¤§äº0çš„åˆ—è¡¨
        return []
    }
    more_tips = more_tips||'é™„åŠ æ•°æ®';//å¯ä¼ ç£åŠ›
    let c = [];//é™„åŠ æ•°æ®å‡½æ•°æœ€ç»ˆè¿”å›ç»“æœ
    let b = [];//é™„åŠ æ•°æ®å¤„ç†ç»“æœ
    let cls = 'more';
    let switch_id = 'more_switch';
    for(let i in more_data){
        let tmp = more_data[i];
        tmp.extra = tmp.extra||{};
        Object.assign(tmp.extra,{id:cls+'_'+i,cls:cls});
        b.push(tmp);
    }
    function getMoreTitle(flag,more_tips,b){
        let drzd = 'â€œâ€œâ€â€<b><span style="color: #FF0000">âˆ¨</span></b>';
        let drzk = 'â€œâ€œâ€â€<b><span style="color: #1aad19">âˆ§</span></b>';
        // let showOrder = getMyVar('é™„åŠ æ•°æ®','æŠ˜å ')==='æŠ˜å '?color('(â˜†å±•å¼€â†‘)','#228be6'):color('(â˜…æŠ˜å â†“)','#d0aa344');
        let showOrder = flag==='æŠ˜å '?(lsg.getItem('æŠ˜å æ ·å¼',drzd)+color('(å·²æŠ˜å )','#228be6')):(lsg.getItem('å±•å¼€æ ·å¼',drzk)+color('(å·²å±•å¼€)','#1aad19'));
        // let showOrder = flag==='æŠ˜å '?color('(â˜†å±•å¼€â†‘)','#228be6'):color('(â˜…æŠ˜å â†“)','#d0aa344');
        return  small(color(more_tips+'åˆ—è¡¨å…±è®¡','#098AC1')+color(b.length,'#d96715')+color('æ¡è®°å½•','#098AC1'))+blank()+right(small(showOrder));
    }
    let switch_title1 = getMoreTitle('æŠ˜å ',more_tips,b);
    let switch_title2 = getMoreTitle('å±•å¼€',more_tips,b);
    c.push({
        title:getMoreTitle(getMyVar('é™„åŠ æ•°æ®','æŠ˜å '),more_tips,b),
        col_type:'text_1',
        url:$('#noLoading#').lazyRule((cls,switch_id,switch_title1,switch_title2,b)=>{
            if(getMyVar('é™„åŠ æ•°æ®','æŠ˜å ')==='å±•å¼€'){
                putMyVar('é™„åŠ æ•°æ®','æŠ˜å ');
                deleteItemByCls(cls);
            }else{
                putMyVar('é™„åŠ æ•°æ®','å±•å¼€');
                addItemAfter('more_switch', b);
            }
            let newTitle = getMyVar('é™„åŠ æ•°æ®','æŠ˜å ')==='æŠ˜å '?switch_title1:switch_title2;
            updateItem(switch_id,{
                title:newTitle
            });
            // refreshPage(true);
            // return 'toast://å·²'+getMyVar('é™„åŠ æ•°æ®')
            return 'hiker://empty'
        },cls,switch_id,switch_title1,switch_title2,b),
        extra:{
            lineVisible:false,
            id:switch_id
        }
    });
    if(getMyVar('é™„åŠ æ•°æ®','æŠ˜å ')==='å±•å¼€'){
        c = c.concat(b);
    }
    return c
}

function äºŒçº§(parse,lazy,dp,é”™è¯¯){
    /*è°ƒç”¨ç¤ºä¾‹
    js:
    let parse={
     title:'',
     img:'',
     url:'',
     desc:'',
     content:'',
     tabs:'',
     lists:'',
    };
    äºŒçº§(parse);
    */
    MY_PARAMS = MY_PARAMS||{};
    é˜…è¯»æ¨¡å¼=(!(typeof (é˜…è¯»æ¨¡å¼) === 'undefined' || !é˜…è¯»æ¨¡å¼));
    äºŒçº§å¤„ç†=(typeof(äºŒçº§å¤„ç†)==='undefined'||!äºŒçº§å¤„ç†)?false:äºŒçº§å¤„ç†;
    å€’åº=(typeof(å€’åº)==='undefined'||!å€’åº)?false:å€’åº;
    ç¼–ç =(typeof(ç¼–ç )==='undefined'||!ç¼–ç )?false:ç¼–ç ;
    åŠ¨æ€æœ€æ–°ç« èŠ‚=(typeof(åŠ¨æ€æœ€æ–°ç« èŠ‚)==='undefined'||!åŠ¨æ€æœ€æ–°ç« èŠ‚)?false:åŠ¨æ€æœ€æ–°ç« èŠ‚;
    æŒ‡å®šcookie=(typeof(æŒ‡å®šcookie)==='undefined'||!æŒ‡å®šcookie)?getMyVar('cookie',''):æŒ‡å®šcookie;
    æŒ‡å®šua=(typeof(æŒ‡å®šua)==='undefined'||!æŒ‡å®šua)?false:æŒ‡å®šua;
    ä¸‹è½½=(typeof(ä¸‹è½½)==='undefined'||!ä¸‹è½½)?false:ä¸‹è½½;
    if(äºŒçº§å¤„ç†){
        äºŒçº§å¤„ç†.é€‰é›†åç§°=äºŒçº§å¤„ç†.é€‰é›†åç§°||é€šç”¨äºŒçº§å¤„ç†.é€‰é›†åç§°;
        äºŒçº§å¤„ç†.é€‰é›†é“¾æ¥=äºŒçº§å¤„ç†.é€‰é›†é“¾æ¥||é€šç”¨äºŒçº§å¤„ç†.é€‰é›†é“¾æ¥;
        äºŒçº§å¤„ç†.å›¾ç‰‡=äºŒçº§å¤„ç†.å›¾ç‰‡||é€šç”¨äºŒçº§å¤„ç†.å›¾ç‰‡;
        äºŒçº§å¤„ç†.å›¾ç‰‡ç‚¹å‡»=äºŒçº§å¤„ç†.å›¾ç‰‡ç‚¹å‡»||é€šç”¨äºŒçº§å¤„ç†.å›¾ç‰‡ç‚¹å‡»;
        äºŒçº§å¤„ç†.é‡å®šå‘=äºŒçº§å¤„ç†.é‡å®šå‘||é€šç”¨äºŒçº§å¤„ç†.é‡å®šå‘; // è¿”å›é‡å®šå‘åçš„æºç 
    }
    //log(typeof(äºŒçº§å¤„ç†.é‡å®šå‘));
    dp=dp||false;
    é”™è¯¯=é”™è¯¯||false;
    let d=[];
    var html;
    let ua = config.ua==='æ‰‹æœº'?MOBILE_UA:PC_UA;
    if(config.æŒ‡å®šua){
        ua = config.æŒ‡å®šua
    }
    if(æŒ‡å®šua&&typeof(æŒ‡å®šua)==='string'){
        ua = æŒ‡å®šua
    }
    let fetchParams = {headers: {
            "User-Agent": ua,
            "Cookie":getMyVar('cookie')
        }};
    var nowUrl = MY_URL.replace('hiker://empty##','').split('#')[0];
    function è¶³è¿¹å¤„ç†(){// è¶³è¿¹å¤„ç†
        let footHistory = lsg.getItem('footHistory','{}');
        try {JSON.parse(footHistory);}catch (e) {lsg.removeItem('footHistory');footHistory='{}'}//ç§»é™¤è¶³è¿¹
        footHistory = JSON.parse(footHistory);
        putMyVar('é€‰é›†ç¿»é¡µ',footHistory[nowUrl]||'1');
    }
    if(MY_URL.startsWith('hiker://empty##')){
        let lastUrl = getMyVar('lastUrl','');
        if(config.html&&lastUrl===nowUrl){
            html = config.html
        }else{
            //html = fetch(tUrl,fetchParams);
            var extra_headers='';
            if(ç¼–ç ){
                extra_headers={
                    "content-type":"charset="+ç¼–ç ||'utf-8',
                };
            }
            html=è·å–æºç (nowUrl,ua,'',æŒ‡å®šcookie,extra_headers);
            //log(html);
            if (/æ£€æµ‹ä¸­/.test(html)){
                html = request(nowUrl + '?btwaf' + html.match(/btwaf(.*?)\"/)[1], {});
            }
            putMyVar('lastUrl',nowUrl);
            initConfig({html:html}); // è‡ªåŠ¨åˆå¹¶æ³¨å…¥
            è¶³è¿¹å¤„ç†();
        }
    }else{
        html=getResCode();
        if (/æ£€æµ‹ä¸­/.test(html)){
            html = request(nowUrl + '?btwaf' + html.match(/btwaf(.*?)\"/)[1], {});
        }
        if(getMyVar('lastUrl','')!==nowUrl){
            putMyVar('lastUrl',nowUrl);
            è¶³è¿¹å¤„ç†();
        }
    }
    let _title=parse.title;
    let _img=parse.img;
    let _url=parse.url;
    let _desc=parse.desc;
    let _col_type=parse.col_type||"movie_1_vertical_pic_blur";
    let _info=parse.content;
    let æ ·å¼ = config.æ ·å¼||'é»˜è®¤'; //å¯ä»¥é»˜è®¤å’Œæ»šåŠ¨
    //æ ·å¼,é»˜è®¤?æ»šåŠ¨
    /*
    let _reChange=parse.reChange||function(playUrl){
        if(typeof(window)!=='undefined'){
            fba.log("å¼€å§‹æ”¹å˜é“¾æ¥");
        }else{
            log("å¼€å§‹æ”¹å˜é“¾æ¥");
        }
        if (/cat\.wkfile\.com\/m3u8/.test(playUrl)){
            playUrl+=";{Referer@https://fantuan.tv}"
        }
        return playUrl
    };
    */
    let _reChange=(parse.reChange && typeof(parse.reChange)==='function')?parse.reChange:false;
    let _tabs=parse.tabs;
    let _tabstr=parse.çº¿è·¯å¤„ç†;
    let _lists=parse.lists;
    let _tab_id=parse.tab_id||false;
    let _list_id=parse.list_id||'a&&href';
    let _list_text=parse.list_text||'a&&Text';
    let _tab_text=parse.tab_text||'body&&Text';
    var bUrl='',bImg='';
    try {bUrl=_url?pd(html,_url):MY_PARAMS.pic_url||''}catch (e) {bUrl=MY_URL.split("##").slice(-1)[0];}
    try {bImg=_img?pd(html,_img):'';}catch (e) {}
    if(isPic(bUrl)&&!/@Referer=/.test(bUrl)){
        bUrl+='@Referer='
    }
    if(äºŒçº§å¤„ç†){
        bImg=äºŒçº§å¤„ç†.å›¾ç‰‡(bImg);
        bUrl=äºŒçº§å¤„ç†.å›¾ç‰‡ç‚¹å‡»(bUrl);
    }
    if(isPic(bImg)&&!/@Referer=/.test(bImg)){
        bImg+='@Referer='
    }else if(/^http/.test(bImg)&&bImg.length>10&&!/@Referer=/.test(bImg)){
        bImg+='@Referer='
    }
    bImg = bImg||MY_PARAMS.pic_url||'';
//https://z3.ax1x.com/2021/11/16/IfaPqf.jpg
//let showlist=parse.showlist||false;
    var title = '',desc='',info='';
    var åˆ†éš”ç¬¦=lsg.getItem('åˆ†éš”ç¬¦','æ¢è¡Œç¬¦')==='æ¢è¡Œç¬¦'?'\n':'  ';
    if(_title){
        let tmpTitle=[];
        for(let it of _title.split(';')){
            try {
                tmpTitle.push(pdfh(addTb(html),it));
            }catch (e) {}
        }
        if(!MY_PARAMS.title&&tmpTitle[0]){//æ²¡ä¼ å‚æ•°å°±å¯èƒ½æ˜¯ä¹¦ç­¾,è®¾ç½®äºŒçº§æ ‡é¢˜
            setPageTitle(tmpTitle[0]);
        }
        title = tmpTitle.join(åˆ†éš”ç¬¦);
    }
    if(_desc){
        let tmpDesc = [];
        for(let it of _desc.split(';')){
            try {
                tmpDesc.push(pdfh(addTb(html),it));
            }catch (e) {}
        }
        desc = tmpDesc.join(åˆ†éš”ç¬¦);
    }
    title = title||MY_PARAMS.title||'æš‚æ— æ ‡é¢˜';
    desc = desc||MY_PARAMS.desc||'æš‚æ— æè¿°';
    info = MY_PARAMS.content||info;
    var ChapterRule = {
        _tabs:_tabs,
        _tab_id:_tab_id,
        _lists:_lists,
        _list_id:_list_id,
        _list_text:_list_text,
        æŒ‡å®šcookie:æŒ‡å®šcookie,
        äºŒçº§å¤„ç†:äºŒçº§å¤„ç†,
        ç¼–ç :ç¼–ç ,
        æŒ‡å®šua:æŒ‡å®šua,
    };
    var bookName = MY_PARAMS.title||title.split(åˆ†éš”ç¬¦)[0];
    var ruleName = MY_RULE.title;
    var rootPath = false;
    if(å€’åº!==false&&å€’åº!=='æ™ºèƒ½'){//ä¼  çœŸ æˆ– ''
        ChapterRule._order=å€’åº?'0':'-1';
    }
    if(åŠ¨æ€æœ€æ–°ç« èŠ‚&&typeof(åŠ¨æ€æœ€æ–°ç« èŠ‚)==='boolean') {
        setLastChapterRule('js:' + $.toString((ChapterRule,MY_PARAMS) => {
            require(config['æ¨¡æ¿']);
            å‡†æœ€æ–°(ChapterRule,MY_PARAMS);
        }, ChapterRule,MY_PARAMS));
    }else if(åŠ¨æ€æœ€æ–°ç« èŠ‚&&typeof(åŠ¨æ€æœ€æ–°ç« èŠ‚)==='function'){
        // åŠ¨æ€æœ€æ–°ç« èŠ‚ä¸ºå‰ªå¤´å‡½æ•° ()=>{}  å…¶ä¸­å‚æ•°å°±æ˜¯ _tabs, _tab_id, _lists, å€’åº
        setLastChapterRule('js:' + $.toString(åŠ¨æ€æœ€æ–°ç« èŠ‚, ChapterRule));
    }
    // log('æœ€æ–°ç« èŠ‚å¤„ç†å®Œæ¯•');
    d.push({
        title:small(title),
        pic_url:dp?bImg||'https://z3.ax1x.com/2021/11/16/IfaPqf.jpg':bImg,
        url:dp?'hiker://page/Route?rule=MyFieldá´°â¿&type=è®¾ç½®#noHistory##noRecordHistory#':bUrl,
        desc:small(desc),
        col_type:_col_type
    });
    setPagePicUrl(bImg); // åŠ¨æ€è®¾ç½®äºŒçº§æ”¶è—å›¾ç‰‡
    // lazy=lazy||é€šå…(_reChange);
    def_lazy=é€šå…(_reChange);
    if(_info||info){
        try {info=(_info?pdfh(html,_info):info)||'æš‚æ— è¯¦æƒ…'}catch (e) {}
        // d.push({
        //     title:color("å‰§æƒ…ç®€ä»‹","#098AC1"),
        //     desc:small(info),
        //     col_type:"text_1",
        //     extra:{
        //         lineVisible: false
        //     },
        //     url:$('hiker://empty#noHistory##noRecordHistory#').rule((info)=>{
        //         let d=[];
        //         d.push({
        //             title:info,
        //             col_type:"long_text"
        //         },info);
        //         setResult(d)
        //     },info)
        // });
        let limit_text = info.substring(0,parseInt(lsg.getItem('ç®€ä»‹å­—æ•°','100')))+'...';
        let download_text = '';
        if(/å°è¯´|æ¼«ç”»/.test(ä¸‹è½½)){
            const Config = $.require("hiker://page/Config.json?rule=æœ¬åœ°èµ„æºç®¡ç†");
            rootPath = ä¸‹è½½==='å°è¯´'?Config.novelPath:Config.comicPath;
            download_text = 'ä¸‹è½½'.link($().b64("'").lazyRule(() => {
                let rule_exits = fetch('hiker://home@æœ¬åœ°èµ„æºç®¡ç†');
                rule_exits = rule_exits!=='null'&&rule_exits!=='';
                if(!rule_exits){
                    return $('æœªå®‰è£…[æœ¬åœ°èµ„æºç®¡ç†]å°ç¨‹åºï¼Œæ— æ³•ä¸‹è½½èµ„æº,ç°åœ¨å®‰è£…?').confirm(()=>{
                        let ruleHead = 'æµ·é˜”è§†ç•Œé¦–é¡µé¢‘é“è§„åˆ™ã€æœ¬åœ°èµ„æºç®¡ç†ã€‘ï¿¥home_rule_urlï¿¥';
                        let rulecode = 'rule://'+base64Encode(ruleHead+'http://hiker.nokia.press/hikerule/rulelist.json?id=3559');
                        return rulecode
                    });
                }else{
                    return "hiker://page/download.view#noHistory##noRecordHistory##noRefresh#?rule=æœ¬åœ°èµ„æºç®¡ç†";
                }
            }));
            download_text+='\t\t\t\t\t';
            download_text+='æ›´æ–°ä¸‹è½½å™¨'.link($().b64("'").lazyRule(() => {
                let ruleHead = 'æµ·é˜”è§†ç•Œé¦–é¡µé¢‘é“è§„åˆ™ã€æœ¬åœ°èµ„æºç®¡ç†ã€‘ï¿¥home_rule_urlï¿¥';
                let rulecode = 'rule://'+base64Encode(ruleHead+'http://hiker.nokia.press/hikerule/rulelist.json?id=3559');
                return rulecode
            }));

            download_text+='\t\t\t\t\t';
            download_text += 'æœ¬åœ°é˜…è¯»'.link($().b64("'").lazyRule((bookName, ruleName,ä¸‹è½½,rootPath) => {
                let rule_exits = fetch('hiker://home@æœ¬åœ°èµ„æºç®¡ç†');
                rule_exits = rule_exits !== 'null' && rule_exits !== '';
                if (!rule_exits) {
                    return $('æœªå®‰è£…[æœ¬åœ°èµ„æºç®¡ç†]å°ç¨‹åºï¼Œæ— æ³•æœ¬åœ°é˜…è¯»,ç°åœ¨å®‰è£…?').confirm(() => {
                        let ruleHead = 'æµ·é˜”è§†ç•Œé¦–é¡µé¢‘é“è§„åˆ™ã€æœ¬åœ°èµ„æºç®¡ç†ã€‘ï¿¥home_rule_urlï¿¥';
                        let rulecode = 'rule://' + base64Encode(ruleHead + 'http://hiker.nokia.press/hikerule/rulelist.json?id=3559');
                        return rulecode
                    });
                } else {
                    // return "hiker://page/NovelBrowser.view?rule=æœ¬åœ°èµ„æºç®¡ç†";

                    let bindUrl = ä¸‹è½½==='å°è¯´'?'hiker://page/NovelBrowser.view':'hiker://page/ComicBrowser.view';
                    let localReadUrl = buildUrl(bindUrl, {
                        hasParams: true,
                        rule: "æœ¬åœ°èµ„æºç®¡ç†",
                        path: encodeURIComponent(rootPath + ruleName + "/" + bookName),
                        name: encodeURIComponent(bookName)
                    });
                    // log(localReadUrl);
                    return localReadUrl
                }
            }, bookName, ruleName,ä¸‹è½½,rootPath));
        }
        let rich_html = ("å‰§æƒ…ç®€ä»‹\t\t\t\t\t"+download_text+"<br><br>").fontcolor("#098AC1")+limit_text.fontcolor("grey").small();
        rich_html = rich_html+"æŸ¥çœ‹è¯¦æƒ…".fontcolor("#098AC1").small().link($().b64("'").rule(d => setResult(d), [{
            title:info,
            col_type:"long_text"
        }]));
        d.push({
            title:rich_html,
            col_type:"rich_text",
            extra:{
                lineVisible: false,
                textSizeb:11,
                lineSpacing:-11
            },
        });
    }
    var tabs;
    var error = function (info){
        return {
            title:'çº¿è·¯å®šä½é”™è¯¯,ä¸ç”¨ç©äº†\nä»”ç»†æ£€æŸ¥æ˜¯ä¸æ˜¯ç½‘ç«™å†…åœ°å€è·³äº†åˆ«çš„ç«™ç‚¹',
            desc:info,
            col_type:'text_1',
            url:'hiker://empty'
        }};
    var redhtml = html;//é»˜è®¤æºç å°±æ˜¯æœ¬èº«è·å¾—çš„
    if(äºŒçº§å¤„ç†&&äºŒçº§å¤„ç†.é‡å®šå‘){
        try {
            redhtml = äºŒçº§å¤„ç†.é‡å®šå‘(MY_URL,html);
        }catch (e) {
            log('è·å–é‡å®šå‘æºç å¤±è´¥:'+e.message);
        }
    }
    if(äºŒçº§å¤„ç†&&äºŒçº§å¤„ç†.é™„åŠ æ•°æ®&&typeof(äºŒçº§å¤„ç†.é™„åŠ æ•°æ®)==='function'){//æœ‰äºŒçº§é™„åŠ æ•°æ®ä¸”è€ƒè™‘é‡å®šå‘é—®é¢˜t
        try {
            let more_data = äºŒçº§å¤„ç†.é™„åŠ æ•°æ®(redhtml);
            let more_title = äºŒçº§å¤„ç†.é™„åŠ æ•°æ®æ ‡é¢˜||false;
            d = d.concat(é™„åŠ æ•°æ®(more_data,more_title));
        }catch (e) {
            log('äºŒçº§é™„åŠ æ•°æ®å¤„ç†å¤±è´¥:'+e.message)
        }
    }
    try {
        var tabs_html = html;
        if(äºŒçº§å¤„ç†&&äºŒçº§å¤„ç†.é‡å®šå‘){
            tabs_html = redhtml;
        }
        if(typeof (_tabs)==='function'){
            tabs = _tabs(tabs_html);
        }else if(typeof (_tabs)==='string'){
            tabs=pdfa(tabs_html,_tabs);
        }else{
            tabs = []
        }
        if(tabs.length<1&&!é”™è¯¯){
            d.push(error('è§£æåˆ°çº¿è·¯åˆ—è¡¨ä¸ºç©º'));
            setResult(d);
            return;
        }else if(tabs.length<1&&é”™è¯¯){
            throw new Error("çº¿è·¯åŒ¹é…å¤±è´¥1");
        }
    }catch (e) {
        if(!é”™è¯¯){
            d.push(error(e.message));
            setResult(d);
            return;
        }else{
            throw new Error("çº¿è·¯åŒ¹é…å¤±è´¥2");
        }
    }

    let showOrder = getMyVar('é¡ºåº','æ­£ç»­')==='é€†åº'?color('(â˜†é€†åºâ†‘)','#228be6'):color('(â˜…æ­£åºâ†“)','#d0aa344');
    d.push({
        title:small(color('é€‰é›†åˆ—è¡¨å…±è®¡','#098AC1')+color(tabs.length,'#d96715')+color('æ¡çº¿è·¯','#098AC1'))+blank()+right(small(showOrder)),
        col_type:'text_1',
        url:$('#noLoading#').lazyRule(()=>{
            if(getMyVar('é¡ºåº','æ­£ç»­')==='é€†åº'){
                putMyVar('é¡ºåº','æ­£ç»­');
            }else{
                putMyVar('é¡ºåº','é€†åº');
            }
            refreshPage(true);
            return 'toast://å·²åˆ‡æ¢é¡ºåºä¸º:'+getMyVar('é¡ºåº','æ­£ç»­')
        }),
        extra:{
            lineVisible:false
        }
    });
    //idæ˜¯tabé‡Œçš„hrefï¼Œ_listsæ˜¯tabå†…æ’­æ”¾åˆ—è¡¨è§£æå¼
    function showlist(id,_lists){
        //_lists=".tab-content&&id&&li";
        if(id){
            _lists=_lists.replace("#id",id);
        }
        return _lists;
    }

    function renderList(showList){//æ¸²æŸ“åˆ—è¡¨
        let allList = [];
        for (let j in showList) {
            let it = showList[j];
            let mytt = pdfh(it, _list_text);
            let colt = config.æŒ‰é’®æ ·å¼?config.æŒ‰é’®æ ·å¼:(showList.length > 10 ? "flex_button" : "text_2");
            let playUrl=pd(it, _list_id);
            if(é˜…è¯»æ¨¡å¼){
                playUrl+='#autoPage##readTheme#';
            }
            if(äºŒçº§å¤„ç†){
                mytt=äºŒçº§å¤„ç†.é€‰é›†åç§°(mytt);
                playUrl=äºŒçº§å¤„ç†.é€‰é›†é“¾æ¥(playUrl);
            }
            allList.push({
                title: mytt,
                url: playUrl + getLazy(playUrl,lazy),
                col_type: colt,
                extra: {
                    id:playUrl,
                    cls:'playList',
                    ua:ua,
                    jsLoadingInject: true,
                    blockRules: ['baidu.*.png', '.mp3', '.mp4', '.flv', '.avi', '.3gp', '.mpeg', '.wmv', '.mov', '.rmvb', '.gif', '.png', '.ico', '.svg']
                }
            });
        }
        return allList
    }


    if(æ ·å¼==='æ»šåŠ¨'){
        let nowTab = parseInt(getMyVar('nowTab','0')||'0');
        // log('nowTab:'+nowTab);
        addListener('onClose', $.toString((nowUrl)=>{
            //log('æ»šåŠ¨æ¨¡å¼ä¸‹æ£€æµ‹åˆ°ç¨‹åºå…³é—­,å¼€å§‹æ¸…å†å²çº¿è·¯');
            //putMyVar("nowTab","0"); //æ¸…é™¤å†å²çº¿è·¯
            //clearMyVar("nowTab");
            require(config['æ¨¡æ¿']);
            let footHistory = lsg.getItem('footHistory','{}');
            try {JSON.parse(footHistory);}catch (e) {lsg.removeItem('footHistory');footHistory='{}'}//ç§»é™¤è¶³è¿¹
            footHistory = JSON.parse(footHistory);
            footHistory[nowUrl] = getMyVar('é€‰é›†ç¿»é¡µ','1');
            // 3å¤©ç¨‹åºè‡ªæ¯
            // lsg.setItem('footHistory',JSON.stringify(footHistory),3600*24*3*1000);
            lsg.setItem('footHistory',JSON.stringify(footHistory));
            // è®¾ç½®è¶³è¿¹é¡µæ•°ç¼“å­˜
            // clearMyVar('é€‰é›†ç¿»é¡µ'); //ä¸æ¸…äº†
            //ä¸ç®¡ç”¨ã€‚ï¼Œå¦ˆè›‹
            // return 'hiker://empty'
        },nowUrl));
        for(let i in tabs){
            let tab_name = pdfh(addTb(tabs[i]),_tab_text);
            if(_tabstr){
                try {
                    tab_name = _tabstr(tab_name)
                }catch (e) {}
            }
            d.push({
                title:nowTab===parseInt(i)?color(tab_name,'#09c11b'):color(tab_name,'#098AC1'),
                url:$('#noLoading#').lazyRule((i,tab_name,nowTab)=>{
                    if(nowTab===parseInt(i)){
                        require(getVar('drä¾èµ–'));
                        let all_cols = [''].concat(getColTypes());
                        let col = (lsg.getItem('æŒ‰é’®æ ·å¼', '')||'');
                        let æŒ‰é’®æ ·å¼ = all_cols.map((it) => {
                            return it === col ? 'ğŸ‘‰' + it : it;
                        });
                        let tips = 'è¯·é€‰æ‹©é€‰é›†æŒ‰é’®æ ·å¼';
                        return $(æŒ‰é’®æ ·å¼, 2, tips).select(() => {
                            require(getVar('drä¾èµ–'));
                            input = input.replace(/ğŸ‘‰/g, '');
                            lsg.setItem('æŒ‰é’®æ ·å¼', input);
                            // config.æŒ‰é’®æ ·å¼ = input;
                            initConfig({æŒ‰é’®æ ·å¼:input});
                            // refreshPage(true);
                            let oldIds = (findItemsByCls('playList')||[]).map(it=>it.extra.id);//è€å…ƒç´ ids
                            // log(oldIds);
                            oldIds.forEach(x=>{
                                updateItem(x, {
                                    col_type:input
                                });
                            });
                            let showList = storage0.getMyVar('showList'); //è·å–å‚¨å­˜çš„é€‰é›†åˆ—è¡¨
                            showList.forEach(x=>{x.col_type = input});
                            storage0.putMyVar('showList',showList);
                            return 'toast://å·²åˆ‡æ¢é€‰é›†æŒ‰é’®æ ·å¼ä¸º:' + input;
                        });
                        // return 'toast://åƒé¥±äº†æ²¡äº‹å„¿å¹²?ç‚¹ä»€ä¹ˆç‚¹!'
                    }
                    putMyVar('nowTab',''+i);
                    refreshPage(false);
                    return 'toast://åˆ‡æ¢çº¿è·¯ä¸º:'+tab_name
                },i,tab_name,nowTab),
                col_type:"scroll_button"
            });
        }
        let id = '0';
        let list = [];
        try {
            id = _tab_id ? (pdfh(addTb(tabs[nowTab]), _tab_id) || (nowTab + '')) : (nowTab + '');
            if(äºŒçº§å¤„ç†&&äºŒçº§å¤„ç†.é‡å®šå‘){
                html = redhtml;
            }
            if(typeof(_lists)==='string'){
                list = pdfa(html, showlist(id, _lists));
            }else if(typeof(_lists)==='function'){
                list = _lists(html,MY_URL,id);
            }
            clearMyVar('çº¿è·¯é”™è¯¯');
        }catch (e) {
            if(getMyVar('nowTab','0')!=='0'){
                putMyVar('nowTab','0');
                refreshPage(false);
                return
            }else {
                if (!é”™è¯¯) {
                    d.push(error(e.message));
                    setResult(d);
                    return;
                } else {
                    throw new Error("è·å–çº¿è·¯åˆ—è¡¨0å¯¹åº”é€‰é›†åˆ—è¡¨é”™è¯¯");
                }
            }
        }
        let ç¿»é¡µé˜€å€¼ = Number(lsg.getItem('ç¿»é¡µé˜€å€¼',40));
        let æ¯é¡µæ•°é‡ = Number(lsg.getItem('æ¯é¡µæ•°é‡',40));
        let æœ€å¤§é¡µæ•° = Math.ceil(list.length/æ¯é¡µæ•°é‡);

        function force_order(list){//å¼ºåˆ¶æ­£åº
            let start = Math.floor(list.length/2); // 0
            let end = Math.min(list.length-1,start+1); // list.slice(-1)[0]
            let first = pdfh(list[start], "a&&Text");
            let second = pdfh(list[end],"a&&Text");
            try{
                if(first.match(/(\d+)/)&&second.match(/(\d+)/)){ //æ•°å­—ç« èŠ‚çš„
                    if(parseInt(first.match(/(\d+)/)[0])>parseInt(second.match(/(\d+)/)[0])){
                        list.reverse()
                    }
                }else{ // ä¸­æ–‡è½¬æ¢
                    if(æ±‰å­—è½¬æ•°å­—(first)>æ±‰å­—è½¬æ•°å­—(second)){
                        list.reverse()
                    }
                }
            }catch(e){}
            return list
        }
        //å¼ºåˆ¶æ­£åºå½“å‰çº¿è·¯ä¸‹çš„é€‰é›†åˆ—è¡¨
        if(list.length>1) {
            list = force_order(list)
        }
        let showList = list;
        let nowPage = Number(getMyVar('é€‰é›†ç¿»é¡µ', '1'))||1; //å½“å‰é¡µæ•°
        if(nowPage>æœ€å¤§é¡µæ•°){//é˜²æ­¢åˆ‡æ¢çº¿è·¯å¯¼è‡´é¡µæ•°æ•°ç»„è¶Šç•Œ
            nowPage = æœ€å¤§é¡µæ•°
        }
        // ç¦æ­¢ åŠ¨æ€åˆ—è¡¨ä½¿ç”¨ç¿»é¡µåŠŸèƒ½
        var canPage = true;
        if(typeof(_lists)==='function'&&/request|fetch|è·å–æºç /.test(_lists.toString())){
            canPage = false;
        }
        if(!canPage&&getMyVar('é€‰é›†æ˜¾ç¤º', 'åˆ†é¡µ') === 'åˆ†é¡µ'){
            putMyVar('é€‰é›†æ˜¾ç¤º', 'å…¨éƒ¨');
        }
        if(list.length>ç¿»é¡µé˜€å€¼&&getMyVar('é€‰é›†æ˜¾ç¤º', 'åˆ†é¡µ') === 'åˆ†é¡µ'){
            let maxNum = æ¯é¡µæ•°é‡*nowPage; //ç¬¬ä¸€é¡µçš„è¯,æœ€å¤§æ˜¾ç¤º40*1é›†,ç¬¬2é¡µ41-80é›†
            showList = list.slice((nowPage-1)*æ¯é¡µæ•°é‡,maxNum);
        }
        if (getMyVar('é¡ºåº', 'æ­£ç»­') === 'é€†åº') {
            showList = showList.reverse();
        }
        let showCol = 'avatar';
        let showPic = '';
        let pageTitleInfo = '';
        function jumpToPageOld(æ¯é¡µæ•°é‡,toPage,nowPage,pageTitleInfo){//è·³é¡µæ—§ç‰ˆ
            if(nowPage===toPage){
                return //è·³è½¬é¡µæ•°ç­‰äºå½“å‰é¡µï¼Œä¸æ“ä½œ
            }
            let toDeleteIds = (findItemsByCls('playList')||[]).map(it=>it.extra.id);
            // deleteItemByCls('playList');
            let showList = storage0.getMyVar('showList'); //è·å–å‚¨å­˜çš„é€‰é›†åˆ—è¡¨
            let maxNum = æ¯é¡µæ•°é‡*toPage; //ç¬¬ä¸€é¡µçš„è¯,æœ€å¤§æ˜¾ç¤º40*1é›†,ç¬¬2é¡µ41-80é›†
            showList = showList.slice((toPage-1)*æ¯é¡µæ•°é‡,maxNum);
            if (getMyVar('é¡ºåº', 'æ­£ç»­') === 'é€†åº') {
                showList = showList.reverse();
            }
            let pageTitle = pageTitleInfo.replace('$page',getMyVar('é€‰é›†ç¿»é¡µ', '1')).replace('$cnt',showList.length);
            pageTitle = pageTitle.replace(/â€œâ€œâ€â€/g,'');
            updateItem('pageTitle',{
                title:pageTitle
            });
            if(Array.isArray(showList)&&showList.length>0){
                addItemAfter('page',showList);
            }
            deleteItem(toDeleteIds);
        }
        function jumpToPage(æ¯é¡µæ•°é‡,toPage,nowPage,pageTitleInfo){//è·³é¡µ
            if(nowPage===toPage){
                return //è·³è½¬é¡µæ•°ç­‰äºå½“å‰é¡µï¼Œä¸æ“ä½œ
            }
            // showLoading(`æ­£åœ¨å‰å¾€ç¬¬${toPage}é¡µ,è¯·ç¨ç­‰`);
            let oldIds = (findItemsByCls('playList')||[]).map(it=>it.extra.id);//è€å…ƒç´ ids
            let showList = storage0.getMyVar('showList'); //è·å–å‚¨å­˜çš„é€‰é›†åˆ—è¡¨
            let maxNum = æ¯é¡µæ•°é‡*toPage; //ç¬¬ä¸€é¡µçš„è¯,æœ€å¤§æ˜¾ç¤º40*1é›†,ç¬¬2é¡µ41-80é›†
            showList = showList.slice((toPage-1)*æ¯é¡µæ•°é‡,maxNum);
            if (getMyVar('é¡ºåº', 'æ­£ç»­') === 'é€†åº') {
                showList = showList.reverse();
            }
            let toDeleteIds = [];//å¾…åˆ é™¤çš„æ—§id
            let toAddDatas = [];//å¾…æ–°å¢çš„æ–°æ•°æ®
            if(oldIds.length > showList.length){
                toDeleteIds = oldIds.slice(showList.length);
            }else if(oldIds.length < showList.length){
                toAddDatas = showList.slice(oldIds.length)
            }
            let cnt = Math.min(oldIds.length,showList.length);
            let pageTitle = pageTitleInfo.replace('$page',getMyVar('é€‰é›†ç¿»é¡µ', '1')).replace('$cnt',showList.length);
            pageTitle = pageTitle.replace(/â€œâ€œâ€â€/g,'');
            updateItem('pageTitle',{
                title:pageTitle
            });
            if(toDeleteIds.length>0){//æœ‰åˆ é™¤çš„å…ˆåˆ é™¤
                deleteItem(toDeleteIds);
            }
            if(toAddDatas.length>0){//æœ‰æ–°å¢çš„å…ˆæ–°å¢
                addItemAfter(oldIds[cnt-1],toAddDatas);
            }
            for(let i=0;i<cnt;i++){//æœ€åé¡ºåºæ›´æ–°
                updateItem(oldIds[i],showList[i]);
            }
            // updateItem(oldIds.slice(0,cnt),showList.slice(0,cnt));//æ‰¹é‡æ›´æ–°?è¯•äº†ä¸è¡Œ
            // hideLoading();
        }
        if(list.length>Number(lsg.getItem('æ¯é¡µæ•°é‡',40))&&canPage) {
            let pageTitle = '';
            if (getMyVar('é€‰é›†æ˜¾ç¤º', 'åˆ†é¡µ') === 'åˆ†é¡µ') {
                // text_1 æ ·å¼
                // pageTitle = color('ç¿»é¡µæ¨¡å¼å·²å¯ç”¨  æœ¬é¡µ:','#585858')+color(showList.length, '#d96715')+color('  å…±è®¡:','#585858')+color(list.length, '#d96715')+color('é›†  ç¬¬:','#585858') + color(getMyVar('é€‰é›†ç¿»é¡µ', '1')+'/'+æœ€å¤§é¡µæ•°, '#d96715')+color('é¡µ','#585858');
                pageTitleInfo = color('ç¿»é¡µæ¨¡å¼å·²å¯ç”¨  æœ¬é¡µ:','#585858')+color('$cnt', '#d96715')+color('  å…±è®¡:','#585858')+color(list.length, '#d96715')+color('é›†  ç¬¬:','#585858') + color('$page'+'/'+æœ€å¤§é¡µæ•°, '#d96715')+color('é¡µ','#585858');
                pageTitleInfo = small(pageTitleInfo);
                pageTitle = pageTitleInfo.replace('$page',getMyVar('é€‰é›†ç¿»é¡µ', '1')).replace('$cnt',showList.length);

                if(showCol==='avatar'){
                    pageTitle = pageTitle.replace(/â€œâ€œâ€â€/g,'');
                    showPic = 'https://hikerfans.com/tubiao/ke/53.png';
                }
            } else {
                // text_1 æ ·å¼
                // pageTitle = color('ç¿»é¡µæ¨¡å¼å·²å…³é—­,ç‚¹å‡»å¯ç”¨','#585858');
                pageTitle = color('ç¿»é¡µæ¨¡å¼å·²å…³é—­,ç‚¹å‡»å¯ç”¨','#585858');
                pageTitle = small(pageTitle);
                if(showCol==='avatar'){
                    pageTitle = pageTitle.replace(/â€œâ€œâ€â€/g,'');
                    showPic = 'https://hikerfans.com/tubiao/ke/123.png';
                }
            }
            d.push({
                title: pageTitle,
                col_type: showCol,
                pic_url:showPic,
                url: $('ç¡®è®¤åˆ‡æ¢åˆ†é¡µæ˜¾ç¤ºçŠ¶æ€?').confirm(() => {
                    putMyVar('é€‰é›†æ˜¾ç¤º', getMyVar('é€‰é›†æ˜¾ç¤º', 'åˆ†é¡µ') === 'åˆ†é¡µ' ? 'å…¨éƒ¨' : 'åˆ†é¡µ');
                    refreshPage(false);
                    return 'hiker://empty'
                }),
                extra:{
                    id:'pageTitle'
                }
            });
            /*
            d.push({
                title:'è·³åˆ°è¯¥é¡µ',
                desc:'è¾“å…¥æ¬²å¿«é€Ÿè·³è½¬çš„é¡µæ•°',
                col_type:'input',
                extra: {
                    onChange: "putMyVar('é€‰é›†ç¿»é¡µ',input)",
                    titleVisible: true,
                    textSize: 11,
                    type: "number",
                    defaultValue:getMyVar('é€‰é›†ç¿»é¡µ','1'),
                },
                url:$.toString(()=>{
                    refreshPage(false);
                    return 'hiker://empty'
                })
            });
             */
            if (getMyVar('é€‰é›†æ˜¾ç¤º', 'åˆ†é¡µ') === 'åˆ†é¡µ') {
                d.push({
                    title: 'âœˆï¸è·³é›†',
                    col_type: "text_5",
                    url: $(list.length,'è¯·è¾“å…¥è¦è·³è½¬åˆ°çš„é›†æ•°').input((max,æ¯é¡µæ•°é‡,pageTitleInfo,jumpToPage)=>{
                        if(isNaN(parseInt(input))){
                            return 'toast://è¾“å…¥æœ‰è¯¯,è¯·è¾“å…¥ä¸€ä¸ª1~'+max+'çš„æ•°å­—'
                        }
                        let toNum = parseInt(input);
                        if(toNum<1||toNum>max){
                            return 'toast://è¾“å…¥æœ‰è¯¯,è¯·è¾“å…¥ä¸€ä¸ª1~'+max+'çš„æ•°å­—'
                        }
                        let nowPage = Number(getMyVar('é€‰é›†ç¿»é¡µ', '1'))||1; //å½“å‰é¡µæ•°
                        let toPage = Math.ceil(toNum/æ¯é¡µæ•°é‡);
                        putMyVar('é€‰é›†ç¿»é¡µ', '' + toPage);
                        // refreshPage(false);
                        jumpToPage(æ¯é¡µæ•°é‡,toPage,nowPage,pageTitleInfo);
                        return 'toast://å·²è·³åˆ°åˆ—è¡¨å…ƒç´ ç¬¬'+toNum+'ä¸ªæ‰€åœ¨é¡µç :'+toPage
                    },list.length,æ¯é¡µæ•°é‡,pageTitleInfo,jumpToPage)
                });
                d.push({
                    title: 'ğŸ”è·³é¡µ',
                    col_type: "text_5",
                    url: $(1,'è¯·è¾“å…¥è¦è·³è½¬åˆ°çš„é¡µæ•°').input((æœ€å¤§é¡µæ•°,æ¯é¡µæ•°é‡,pageTitleInfo,jumpToPage)=>{
                        if(isNaN(parseInt(input))){
                            return 'toast://è¾“å…¥æœ‰è¯¯,è¯·è¾“å…¥ä¸€ä¸ª1~'+æœ€å¤§é¡µæ•°+'çš„æ•°å­—'
                        }
                        let toPage = parseInt(input);
                        if(toPage<1||toPage>æœ€å¤§é¡µæ•°){
                            return 'toast://è¾“å…¥æœ‰è¯¯,è¯·è¾“å…¥ä¸€ä¸ª1~'+æœ€å¤§é¡µæ•°+'çš„æ•°å­—'
                        }
                        let nowPage = Number(getMyVar('é€‰é›†ç¿»é¡µ', '1'))||1; //å½“å‰é¡µæ•°
                        putMyVar('é€‰é›†ç¿»é¡µ', '' + toPage);
                        // refreshPage(false);
                        jumpToPage(æ¯é¡µæ•°é‡,toPage,nowPage,pageTitleInfo);
                        return 'toast://å·²è·³åˆ°ç¬¬'+toPage+'é¡µ'
                    },æœ€å¤§é¡µæ•°,æ¯é¡µæ•°é‡,pageTitleInfo,jumpToPage)
                });
                d.push({
                    title: 'â®ï¸ä¸Šé¡µ',
                    col_type: "text_5",
                    url: $('#noLoading#').lazyRule((æ¯é¡µæ•°é‡,pageTitleInfo,jumpToPage) => {
                        let nowPage = parseInt(getMyVar('é€‰é›†ç¿»é¡µ', '1'))||1;
                        let toPage = nowPage - 1;
                        if(toPage>0) {
                            putMyVar('é€‰é›†ç¿»é¡µ', '' + toPage);
                            // refreshPage(false);
                            jumpToPage(æ¯é¡µæ•°é‡,toPage,nowPage,pageTitleInfo);
                            return 'hiker://empty'
                        }else{
                            return 'toast://å·²ç»æ²¡æœ‰ä¸Šä¸€é¡µäº†!'
                        }
                    },æ¯é¡µæ•°é‡,pageTitleInfo,jumpToPage)
                });
                d.push({
                    title: 'â­ï¸ä¸‹é¡µ',
                    col_type: "text_5",
                    url: $('#noLoading#').lazyRule((æœ€å¤§é¡µæ•°,æ¯é¡µæ•°é‡,pageTitleInfo,jumpToPage) => {
                        let nowPage = parseInt(getMyVar('é€‰é›†ç¿»é¡µ', '1'))||1;
                        let toPage = nowPage + 1;
                        if(toPage>æœ€å¤§é¡µæ•°){
                            return 'toast://å·²ç»æ²¡æœ‰ä¸‹ä¸€é¡µäº†!'
                        }
                        putMyVar('é€‰é›†ç¿»é¡µ', '' + toPage);
                        // refreshPage(false);
                        jumpToPage(æ¯é¡µæ•°é‡,toPage,nowPage,pageTitleInfo);
                        return 'hiker://empty'
                    },æœ€å¤§é¡µæ•°,æ¯é¡µæ•°é‡,pageTitleInfo,jumpToPage)
                });
                d.push({
                    title: 'ğŸ”šå°¾é¡µ',
                    col_type: "text_5",
                    url: $('#noLoading#').lazyRule((æœ€å¤§é¡µæ•°,æ¯é¡µæ•°é‡,pageTitleInfo,jumpToPage) => {
                        let toPage = æœ€å¤§é¡µæ•°;
                        let nowPage = Number(getMyVar('é€‰é›†ç¿»é¡µ', '1'))||1; //å½“å‰é¡µæ•°
                        putMyVar('é€‰é›†ç¿»é¡µ', ''+toPage);
                        // refreshPage(false);
                        jumpToPage(æ¯é¡µæ•°é‡,toPage,nowPage,pageTitleInfo);
                        return 'toast://å·²è·³è½¬åˆ°ç¬¬'+æœ€å¤§é¡µæ•°+'é¡µ'
                    },æœ€å¤§é¡µæ•°,æ¯é¡µæ•°é‡,pageTitleInfo,jumpToPage)
                });
                d.push({
                    col_type:"line_blank",
                    extra:{
                        id:'page' // ç»™ç¿»é¡µç»„ä»¶åšidç”¨
                    }
                })
            }
        }
        function getChapterList(showList){
            return showList.map((it) => {
                let mytt = pdfh(it, _list_text);
                let playUrl=pd(it, _list_id);
                if(äºŒçº§å¤„ç†){
                    mytt=äºŒçº§å¤„ç†.é€‰é›†åç§°(mytt);
                    playUrl=äºŒçº§å¤„ç†.é€‰é›†é“¾æ¥(playUrl);
                }
                return {
                    title:mytt,
                    url:playUrl,
                }});
        }
        if(/å°è¯´|æ¼«ç”»/.test(ä¸‹è½½)){
            let chapterList = getChapterList(showList);
            let chapterListAll = getChapterList(list);
            let chapterListFile = rootPath + ruleName + "/" + bookName+'/chapterListAll.json';
            chapterListFile = chapterListFile.replace('/å°è¯´/','/drç« èŠ‚ç¼“å­˜/å°è¯´/').replace('/æ¼«ç”»/','/drç« èŠ‚ç¼“å­˜/æ¼«ç”»/');
            // log(chapterListAll.length);
            // log(chapterListFile);
            writeFile(chapterListFile,JSON.stringify(chapterListAll));
            let downloadInfo = {};
            if(ä¸‹è½½==='å°è¯´'){
                downloadInfo = {
                    bookName: bookName,
                    ruleName: ruleName,
                    bookTopPic: bImg,
                    // topPicHeaders: !bImg.includes('@Referer=')?{}:{'Referer':bImg.split('@Referer=')[1].split('&')[0]},
                    // bookTopPic: bImg.split('@Referer=')[0],
                    parseCode: $.toString((å®šä½,ç¼–ç ,cookie) => {
                        require(getVar('drä¾èµ–'));
                        putMyVar('cookie',cookie);
                        return ç« èŠ‚å†…å®¹(input,å®šä½,ç¼–ç );
                    },å®šä½,ç¼–ç ,getMyVar('cookie','')),
                    type:"novel"
                };
            }else if(ä¸‹è½½==='æ¼«ç”»'){
                downloadInfo = {
                    bookName: bookName,
                    ruleName: ruleName,
                    bookTopPic: bImg,
                    // bookTopPic: bImg.split('@Referer=')[0],
                    // topPicHeaders: !bImg.includes('@Referer=')?{}:{'Referer':å®šä½.æ¥æº||bImg.split('@Referer=')[1].split('&')[0]},
                    parseCode: $.toString((å®šä½,cookie) => {
                        require(getVar('drä¾èµ–'));
                        putMyVar('cookie',cookie);
                        return ä¸‹è½½å›¾ç‰‡(input,å®šä½);
                    },å®šä½,getMyVar('cookie','')),
                };
            }
            download_extra = {
                // chapterListFile:chapterListFile,
                //chapterList: chapterList,
                chapterList: chapterListFile,
                info: downloadInfo,
                defaultView:ä¸‹è½½==='å°è¯´'?'0':'1'
            };
            Object.assign(d[1].extra, download_extra);
        }
        d = d.concat(renderList(showList));
        storage0.putMyVar('showList',renderList(list));

    }else {
        for (let i in tabs) {
            let tab_name = pdfh(tabs[i], _tab_text);
            if (_tabstr) {
                try {
                    tab_name = _tabstr(tab_name)
                } catch (e) {
                }
            }
            d.push({
                title: color(tab_name, '#098AC1'),
                url: "hiker://empty",
                col_type: "text_1"
            });
            let id = _tab_id ? (pdfh(tabs[i], _tab_id) || (i + '')) : (i + '');
            let list = [];
            if(äºŒçº§å¤„ç†&&äºŒçº§å¤„ç†.é‡å®šå‘){
                html = redhtml;
            }
            if(typeof(_lists)==='string'){
                list = pdfa(html, showlist(id, _lists));
            }else if(typeof(_lists)==='function'){
                list = _lists(html,MY_URL,id);
            }
            if (getMyVar('é¡ºåº', 'æ­£ç»­') === 'é€†åº') {
                list = list.reverse();
            }
            d = d.concat(renderList(list));
        }
    }
    setResult(d);
    return d;
}
function æœ€æ–°æºç (MY_URL,æŒ‡å®šcookie,äºŒçº§å¤„ç†,ç¼–ç ,æŒ‡å®šua){
    æŒ‡å®šcookie = æŒ‡å®šcookie||getMyVar('cookie');
    äºŒçº§å¤„ç†=äºŒçº§å¤„ç†||false;
    ç¼–ç =ç¼–ç ||'utf-8';
    let ua = config.ua==='æ‰‹æœº'?MOBILE_UA:PC_UA;
    æŒ‡å®šua=æŒ‡å®šua||ua;
    if(/^hiker:\/\/empty##/.test(MY_URL)){
        MY_URL=MY_URL.split("##").slice(-1)[0];
        // log('æŒ‡å®šcookie:'+æŒ‡å®šcookie+',myVar:'+getMyVar('cookie'));
        // let fetchParams = {headers: {"User-Agent":ua,"cookie":getMyVar('cookie')}};
        let fetchParams = {headers: {"User-Agent":æŒ‡å®šua,"cookie":æŒ‡å®šcookie,
                "content-type": "charset="+ç¼–ç 
            }};
        var html=fetch(MY_URL,fetchParams);
        if(äºŒçº§å¤„ç†&&typeof(äºŒçº§å¤„ç†.é‡å®šå‘)=='function'){
            html=äºŒçº§å¤„ç†.é‡å®šå‘(MY_URL,html);
        }
        // log('æœ€æ–°æºç cookie:'+æŒ‡å®šcookie);
        // var html = è·å–æºç (MY_URL,'','','',æŒ‡å®šcookie);
        // log('æœ€æ–°æºç html:'+html);
    }else{
        var html = getResCode();
    }
    return html
}
function æœ€æ–°(newStr){
    var html=æœ€æ–°æºç (MY_URL);
    newStr=newStr.replace(/#id/,'0');
    log(newStr);
    var newtips = MY_RULE.title+"|æ›´æ–°è‡³"+pdfh(html, newStr);
    setResult(newtips);
}

function å‡†æœ€æ–°(ChapterRule,MY_PARAMS){
    cat = ChapterRule;
    if((!cat)||(typeof(cat)!=='object')){
        setResult('æ£€æµ‹æ›´æ–°å¤±è´¥.å‚æ•°æœ‰è¯¯');
        return;
    }
    æŒ‡å®šcookie = cat.æŒ‡å®šcookie||getMyVar('cookie');
    äºŒçº§å¤„ç†=cat.äºŒçº§å¤„ç†||false;
    ç¼–ç =cat.ç¼–ç ||'utf-8';
    //log(MY_URL);
    var html=æœ€æ–°æºç (MY_URL,æŒ‡å®šcookie,äºŒçº§å¤„ç†,ç¼–ç ,cat.æŒ‡å®šua);
    //log(html);
    var _tabs,_tab_id,_lists,_order,_list_id,_list_text;
    _tabs = cat._tabs;
    _tab_id = cat._tab_id;
    _lists = cat._lists;
    _list_id = cat._list_id||'a&&href';
    _list_text = cat._list_text||'a&&Text';
    if(typeof(cat._order)==='undefined'){
        _order='æ™ºèƒ½';
    }else if(cat._order==='æ™ºèƒ½'){
        _order='æ™ºèƒ½';
    } else {
        _order=cat._order?cat._order:'-1';
    }
    function showlist(id,_lists){
        return id?_lists.replace("#id",id):_lists;
    }
    var tabs = [];
    if(typeof (_tabs)==='function'){
        tabs = _tabs(html);
    }else if(typeof (_tabs)==='string'){
        tabs=pdfa(html,_tabs);
    }
    var rlist=[];
    for (let i in tabs) {
        let id = _tab_id ? (pdfh(tabs[i], _tab_id) || (i + '')) : (i + '');
        var list = [];
        if(typeof(_lists)==='string'){
            list = pdfa(html, showlist(id, _lists));
        }else if(typeof(_lists)==='function'){
            list = _lists(html,MY_URL,id);
        }
        if(list.length>rlist.length){
            rlist=list
        }
    }
    let newCap='';
    if(_order==='æ™ºèƒ½'){
        // log('å…±è®¡é€‰é›†æ•°é‡:'+rlist.length);
        let start = Math.floor(rlist.length/2); // 0
        let end = Math.min(rlist.length-1,start+1); // list.slice(-1)[0]
        let first = pdfh(rlist[start], _list_text||"a&&Text");
        let second = pdfh(rlist[end],_list_text||"a&&Text");
        if(äºŒçº§å¤„ç†){
            first=äºŒçº§å¤„ç†.é€‰é›†åç§°(first);
            second=äºŒçº§å¤„ç†.é€‰é›†åç§°(second);
        }
        //log(rlist.slice(-1));
        newCap=pdfh(rlist.slice(-1)[0], _list_text||"a&&Text");
        //log('first:'+first);
        //log('second:'+second);
        try{
            if(first.match(/(\d+)/)&&second.match(/(\d+)/)){ //æ•°å­—ç« èŠ‚çš„
                if(parseInt(first.match(/(\d+)/)[0])>parseInt(second.match(/(\d+)/)[0])){
                    newCap=pdfh(rlist[0], _list_text||"a&&Text");
                }
            }else{ // ä¸­æ–‡è½¬æ¢
                if(æ±‰å­—è½¬æ•°å­—(first)>æ±‰å­—è½¬æ•°å­—(second)){
                    newCap=pdfh(rlist[0], _list_text||"a&&Text");
                }
            }
        }catch(e){}
        // log('æ±‰å­—è½¬æ•°å­—ç¬¬ä¸€ç™¾ä¸€åäºŒç« :'+æ±‰å­—è½¬æ•°å­—('ç¬¬ä¸€ç™¾ä¸€åäºŒç« '));
    }else{
        newCap=pdfh(rlist.slice(parseInt(_order))[0],_list_text||"a&&Text");
    }
    MY_PARAMS = MY_PARAMS||{};
    let ruleName = (MY_PARAMS.name||MY_RULE.title);
    // log(ruleName+'æ™ºèƒ½æœ€æ–°ç« èŠ‚è§£ææˆåŠŸ:'+newCap);
    var newtips = "æ›´æ–°è‡³"+newCap;
    if(ruleName!==MY_RULE.title){
        newtips = ruleName+'|'+newtips
    }
    log(newtips);
    setResult(newtips);
}
function æ³¨å…¥(id){
    id=id||'buttons';
    if(typeof(log)=="undefiend"){
        log=fy_bridge_app.log;
    }
    log("å¼€å§‹æ³¨å…¥js");
    const {isVideo} = $.require('hiker://page/globalParse?rule=é“é•¿ä»“åº“Pro');
    var js=$.toString((isVideo,id)=>{
        var btn = document.createElement('button');
        btn.setAttribute('style','border-radius:20px;width:32px;height:32px;');
        btn.setAttribute('id','btn1');
        btn.innerText = 'ä¸‹è½½';
        btn.onclick=function(){
            var urls = _getUrls();
            //fba.log(JSON.stringify(urls));
            //alert("å¼€å§‹ä¸‹è½½");
            //let realUrl=false;
            let playUrl=urls.slice(-1)[0];
            let realUrl=isVideo(playUrl);
            if(typeof(realUrl)=='string'){
                fba.log("ä»“åº“x5å…å—…ç»“æœ:"+realUrl);
            }
            if(realUrl){
                if(confirm("è¿›å…¥exoæ’­æ”¾?")){
                    fba.playVideo(realUrl);
                }
            }else{
                alert("æ²¡æœ‰è§†é¢‘ï¼Œè¯·å…ˆæ’­æ”¾");
            }
        }
        var main = document.getElementById(id);
        main.appendChild(btn);
    },isVideo,id);
    return js
}
function è·å–ck(set){
    var ckpath='hiker://files/cache/cookie.json';
    var oldck=fetch(ckpath)||'{}';
//log('æ—§çš„cookie:'+oldck);
    oldck=JSON.parse(oldck);
    return oldck[set]||''
}
function æ³¨å…¥éªŒè¯ç è¯†åˆ«(id,set,extra){
    // id=id||'.tncode';
    id=id||'';
    set=set||'yzm_cookie';
    extra=extra||{};
    if(typeof(log)=="undefiend"){
        log=fy_bridge_app.log;
    }
    var js=$.toString((id,set,extra)=>{
        eval(fy_bridge_app.getInternalJs());
        //fba.log('è¿›å…¥x5å¤„ç†ä¸­');
        //fba.log(fba.getVar('drä¾èµ–'));
        var ckpath='hiker://files/cache/cookie.json';
        function cookieSet(){
            // fba.log('è‡ªåŠ¨cookieè®¾ç½®:' + set + '=>' + document.cookie);
            //JSON.stringify
            //JSON.parse
            var oldck = request(ckpath) || '{}';
            fba.log('æ—§çš„cookie:' + oldck);
            oldck = JSON.parse(oldck);
            oldck[set] = document.cookie;
            fba.putVar(set, document.cookie);
            var newCk = JSON.stringify(oldck);
            fba.writeFile(ckpath, newCk);
            fba.log('æ–°çš„cookie:' + newCk);
        }
        if(id) { //å¡«äº†idçš„è¯
            var btn = document.createElement('button');
            let css = extra.æ ·å¼ || 'border-radius:20px;width:auto;height:20px;';
            btn.setAttribute('style', css);
            btn.setAttribute('id', 'btn1');
            let text = extra.æ–‡å­— || 'å®Œæˆå¹¶è¿”å›é‡è¯•';
            btn.innerText = text;
            btn.onclick = function () {
                try {
                    fba.log('æ‰‹åŠ¨ç‚¹å‡»cookieè®¾ç½®:' + set + '=>' + document.cookie);
                    cookieSet();
                    if (confirm('å·²è®¾ç½®å½“å‰é¡µcookieï¼Œè¿”å›æŸ¥çœ‹æœç´¢ç»“æœã€‚è¿”å›åéœ€è¦æ‰‹åŠ¨ä¸‹æ‹‰åˆ·æ–°ï¼ï¼ï¼')) {
                        fba.parseLazyRule('hiker://empty@lazyRule=.js:back()');
                    }

                } catch (e) {
                    alert(e.message)
                }
            }
            var main = document.querySelector(id);
            main.appendChild(btn);
        }else{//æ²¡å¡«å°±è‡ªåŠ¨æ³¨å…¥ï¼Œåˆ·æ–°éƒ½ç®—
            if(document.cookie) {//å¦‚æœæœ‰cookie
                try {
                    fba.log('è‡ªåŠ¨cookieè®¾ç½®:' + set + '=>' + document.cookie);
                    cookieSet();
                } catch (e) {
                    alert(e.message)
                }
            }
        }
    },id,set,extra);
    return js
}

function é“é•¿éªŒè¯ç (title,myurl,id,set,extra){

    if(getVar(set,'')&&!getMyVar('cookie')){
        putMyVar('cookie',getVar(set,''));
        refreshPage(true);
        return;
    }

//å¿…å¡«é“¾æ¥ï¼Œidï¼Œcookieåç§°
    extra=extra||false;
    title=title||'ç½‘ç«™è§¦å‘äº†äººæœºéªŒè¯ï¼Œç‚¹æ­¤å¤„ç†';
    /*
    var url=$().lazyRule((title,MY_URL,id,set,extra,æ³¨å…¥éªŒè¯ç è¯†åˆ«)=>{
    if(getVar(set,'')&&!getMyVar('cookie')){
    putMyVar('cookie',getVar(set,''));
    refreshPage(true);
    return'hiker://empty';
    }
    return $(MY_URL).rule((æ³¨å…¥éªŒè¯ç è¯†åˆ«,id,set,extra)=>{
                //log(typeof(æ³¨å…¥éªŒè¯ç è¯†åˆ«))
                let d=[];
                d.push({
                 col_type: "x5_webview_single",
                 url: MY_URL,
                 desc: "float&&100%",
                 extra: {
                   canBack: true,
                   js:æ³¨å…¥éªŒè¯ç è¯†åˆ«(id,set,extra)
                  }});
                setResult(d);
          },æ³¨å…¥éªŒè¯ç è¯†åˆ«,id,set,extra);

    },title,MY_URL,id,set,extra,æ³¨å…¥éªŒè¯ç è¯†åˆ«);
    */
//log('å¾…æ³¨å…¥:'+MY_URL);
    var url=$(myurl).rule((æ³¨å…¥éªŒè¯ç è¯†åˆ«,id,set,extra)=>{
        //log(typeof(æ³¨å…¥éªŒè¯ç è¯†åˆ«))
        input=MY_URL;
        require(getVar('drä¾èµ–'));
        //log('æ³¨å…¥äº†:'+MY_URL);
        var oldck=è·å–ck(set);
        setPageTitle('é“é•¿éªŒè¯ç é€šæ€');
        addListener('onClose', $.toString((set,oldck,è·å–ck)=>{
            // log(MY_TYPE)ï¼Œé¦–é¡µå°†æ‰“å°homeï¼Œæœç´¢ä¸ºsearch
            log('é€€å‡ºäº†é€šæ€ç•Œé¢,æ—§çš„cookieä¸º:'+oldck);
            let newck=è·å–ck(set);
            log('æ–°çš„cookieä¸º:'+newck);
            if(!newck){
                let error='æœªè·å–cookieï¼ŒéªŒè¯å¤±è´¥ï¼';
                log(error);
                //setError(error);
                //throw error;
            }else if(oldck===newck){
                log('cookieæœªæ›´æ–°ï¼ŒéªŒè¯å¯èƒ½æœªé€šè¿‡');
            }
            if(MY_TYPE!=='search'){
                refreshPage(false); //éæœç´¢è¿‡éªŒè¯è¿”å›è‡ªåŠ¨åˆ·æ–°ä½¿è®¾ç½®ç”Ÿæ•ˆ
            }
        },set,oldck,è·å–ck));
        let d=[];
        d.push({
            col_type: "x5_webview_single",
            url: input,
            desc: "float&&100%",
            extra: {
                canBack: true,
                js:æ³¨å…¥éªŒè¯ç è¯†åˆ«(id,set,extra)
            }});
        setResult(d);
    },æ³¨å…¥éªŒè¯ç è¯†åˆ«,id,set,extra);
    let d=[];
    d.push({
        title:title,
        col_type:'text_1',
        url:url,
    });
    setResult(d);
    // $().b64().rule()  å¯ä»¥å®ç°åœ¨lazyRuleé‡Œè¿”å›rule
}
